import{d as L,Q as Oe,u as de,S as ae,z as X,r as I,c as T,V as W,o as s,a as r,b as e,F as E,m as C,W as pe,t as x,h as y,p as V,w as re,v as me,e as m,X as we,M as te,x as h,Y as F,Z as fe,$ as Ce,n as B,O as N,a0 as ye,i as J,a1 as Pe,_ as j,D as se,a2 as De,a3 as he,q,f as Y,a4 as Se,a5 as ve,a6 as be,g as _e,a7 as Ge,a8 as ke,a9 as Le,aa as Re,J as Ae,ab as je,ac as Ue,K as He,R as Be,L as Ne,ad as We,ae as qe,af as Ke,ag as Me,k as ne,j as Z,ah as Ve,ai as Qe,aj as oe,ak as ee,al as Ye,am as Xe,an as Ze,ao as Je,ap as et,aq as tt,ar as st,as as ie,at as ot,au as at,av as lt,aw as nt,ax as Ie,ay as it,az as rt,s as dt,aA as ut,l as $e,A}from"./index-2658e7f4.js";import{_ as pt}from"./Tutorial-3004321d.js";const ce={},ct={class:"d-flex flex-row"},mt={key:2,class:"d-flex",style:{width:"150px"}},vt={class:"flex-grow-1"},gt={key:1,style:{"padding-top":"1px"}},ft={style:{width:"20px","margin-top":"2px"},class:"text-center"},_t={key:4,class:"text-center",style:{width:"20px","margin-top":"2px"}},yt={key:0},ht={key:0,class:"ms-3 pt-1"},bt={key:1},kt=L({__name:"PropertyOptions",props:{property:{},open:{type:Boolean}},setup(S){const{t:f}=Oe({useScope:"global"}),t=de(),o=ae(),d=X(),u=o.getTabManager(),i=S,g=I(!1),p=I(!1),l=I(""),n=I(!1),a=T(()=>o.getTab()),c=T(()=>a.value.visibleProperties[i.property.id]==!0),k=T(()=>u.collection.filterManager.state.filter.filters.some(D=>!D.isGroup&&D.propertyId==i.property.id)),$=T(()=>u.collection.groupManager.state.groupBy.includes(i.property.id)),G=T(()=>u.collection.sortManager.state.sortBy.includes(i.property.id)),P=T(()=>{if(k.value)return u.collection.filterManager.state.filter.filters.find(D=>!D.isGroup&&D.propertyId==i.property.id).id}),v=()=>u.collection.filterManager,_=T(()=>u.getSha1Mode());function w(){c.value?u.setVisibleProperty(i.property.id,!1):u.setVisibleProperty(i.property.id,!0)}function b(){i.open&&(g.value?g.value=!1:(g.value=!0,l.value=i.property.name),p.value=!1)}function M(){i.property.type!=N.tag&&i.property.type!=N.multi_tags||(p.value?p.value=!1:p.value=!0,g.value=!1)}function O(){G.value?u.collection.sortManager.delSort(i.property.id):u.collection.sortManager.setSort(i.property.id),u.collection.sortManager.update(!0)}function U(){$.value?u.collection.groupManager.delGroupOption(i.property.id):u.collection.groupManager.setGroupOption(i.property.id),u.collection.groupManager.update(!0)}function R(){confirm(f("common.properties.delete")+": "+i.property.name+" ?   "+i.property.id)&&d.deleteProperty(i.property.id)}async function H(){l.value!=""&&(await d.updateProperty(i.property.id,l.value),b())}function Q(){const D=v();k.value?(D.deleteFilter(P.value),ce.filter.hide()):(D.addNewFilter(i.property.id),ce.filter.show())}return W(()=>i.property,()=>{g.value=!1}),(D,z)=>(s(),r("div",{class:B(n.value?"hover-light":"")},[e("div",ct,[i.open?(s(),r(E,{key:0},[g.value?y("",!0):(s(),r("div",{key:0,class:"option-holder hover-light btn-icon",style:{width:"150px"},onClick:b},[C(pe,{type:i.property.type,class:"me-2 btn-icon",onMouseenter:z[0]||(z[0]=K=>n.value=!0),onMouseleave:z[1]||(z[1]=K=>n.value=!1)},null,8,["type"]),e("span",null,x(i.property.name),1)]))],64)):(s(),V(pe,{key:1,type:i.property.type,class:"me-2",style:{position:"relative",top:"2px"}},null,8,["type"])),g.value&&i.open?(s(),r("div",mt,[e("div",null,[e("i",{class:"btn-icon me-1 bi bi-x-lg",style:{padding:"2px"},onClick:b,onMouseenter:z[2]||(z[2]=K=>n.value=!0),onMouseleave:z[3]||(z[3]=K=>n.value=!1)},null,32)]),e("div",vt,[i.property.id>=0?re((s(),r("input",{key:0,style:{position:"relative",top:"1px"},type:"text",class:"text-input","onUpdate:modelValue":z[4]||(z[4]=K=>l.value=K),onChange:H},null,544)),[[me,l.value]]):(s(),r("span",gt,[C(pe,{type:i.property.type,class:"me-2 btn-icon"},null,8,["type"]),e("span",null,x(i.property.name),1)]))])])):y("",!0),i.open?(s(),r(E,{key:3},[m(we)(i.property.type)?(s(),r("div",{key:0,style:{width:"20px","margin-top":"2px",cursor:"pointer"},class:"text-center",onClick:z[5]||(z[5]=K=>m(t).showModal(m(te).TAG,{propId:i.property.id}))},[C(F,{click:!1,message:"main.nav.properties.open_tags"},{default:h(()=>z[7]||(z[7]=[e("i",{class:"bi bi-arrows-fullscreen"},null,-1)])),_:1})])):y("",!0),e("div",ft,[i.property.mode==m(fe).id?(s(),V(F,{key:0,click:!1,message:"main.nav.properties.linked_property_tooltip"},{default:h(()=>z[8]||(z[8]=[e("i",{class:"bi bi-link-45deg"},null,-1)])),_:1})):y("",!0)])],64)):y("",!0),e("div",{style:{width:"20px","margin-top":"2px"},onClick:w,class:"btn-icon text-center"},[_.value&&i.property.mode==m(fe).id?(s(),V(F,{key:0,message:"main.nav.properties.hidden_property_tooltip"},{default:h(()=>[e("span",{class:"bi bi-eye-slash",onClick:z[6]||(z[6]=Ce(()=>{},["stop"]))})]),_:1})):(s(),V(F,{key:1,pos:"right",message:"main.nav.properties.hide_property_tooltip"},{default:h(()=>[e("span",{class:B("bi bi-eye text-"+(c.value?"primary":"secondary"))},null,2)]),_:1}))]),i.open?(s(),r("div",_t,[i.property.type==m(N).tag||i.property.type==m(N).multi_tags?(s(),r("div",{key:0,onClick:M,style:{cursor:"pointer"}},[p.value?(s(),V(F,{key:0,message:"main.nav.properties.collapse_property_tooltip"},{default:h(()=>z[9]||(z[9]=[e("i",{class:"bi bi-chevron-down"},null,-1)])),_:1})):(s(),V(F,{key:1,message:"main.nav.properties.expand_property_tooltip"},{default:h(()=>z[10]||(z[10]=[e("i",{class:"bi bi-chevron-right"},null,-1)])),_:1}))])):y("",!0)])):y("",!0)]),i.open?(s(),r("div",yt,[g.value?(s(),r("div",ht,[D.property.id!=m(ye).folders?(s(),r("div",{key:0,class:B(["options hover-light",k.value?" text-primary":""]),onClick:Q},[e("div",null,[z[11]||(z[11]=e("i",{class:"bi bi-funnel-fill me-2"},null,-1)),J(x(D.$t("main.menu.filters")),1)])],2)):y("",!0),e("div",{class:B(["options hover-light",G.value?" text-primary":""]),onClick:O},[z[12]||(z[12]=e("i",{class:"bi bi-filter me-2"},null,-1)),J(x(D.$t("main.menu.sort.title")),1)],2),e("div",{class:B(["options hover-light",$.value?" text-primary":""]),onClick:U},[z[13]||(z[13]=e("i",{class:"bi bi-collection me-2"},null,-1)),J(x(D.$t("main.menu.groupby")),1)],2),i.property.id>=0?(s(),r("div",{key:1,class:"options hover-light",onClick:R},[z[14]||(z[14]=e("i",{class:"bi bi-trash me-2"},null,-1)),J(x(D.$t("main.nav.properties.delete_property")),1)])):y("",!0)])):p.value?(s(),r("div",bt,[C(Pe,{property:i.property,"can-create":!0,"can-customize":!0,"can-delete":!0,"can-link":!0},null,8,["property"])])):y("",!0)])):y("",!0)],2))}});const xe=j(kt,[["__scopeId","data-v-908dfa0f"]]),$t={class:"text-nowrap"},xt=["onClick"],wt=["onClick"],Ct=L({__name:"FolderOptionDropdown",props:{folder:{}},setup(S){const f=X(),t=S;function o(){f.reImportFolder(t.folder.id)}function d(){confirm(De.global.t("main.nav.folders.del_alert"))&&f.deleteFolder(t.folder.id)}return(u,i)=>(s(),V(se,{teleport:!0},{button:h(()=>i[0]||(i[0]=[e("i",{class:"bi bi-three-dots base-hover"},null,-1)])),popup:h(({hide:g})=>[e("div",$t,[e("div",{class:"p-2 bb",onClick:p=>{o(),g()}},i[1]||(i[1]=[e("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),J("Re import")]),8,xt),i[3]||(i[3]=e("div",{class:"custom-hr"},null,-1)),e("div",{class:"bb p-2",onClick:p=>{d(),g()}},[i[2]||(i[2]=e("i",{class:"bi bi-trash me-1"},null,-1)),J(x(u.$t("main.nav.folders.del")),1)],8,wt)])]),_:1}))}}),St=["onMouseenter"],Mt={style:{display:"inline"}},Vt=["onClick"],It={class:"text-secondary"},Ft=["onClick"],Tt=L({__name:"FolderList2",props:{folders:Array,visibleFolders:Object,filterManager:he,root:{type:Boolean,default:!0}},setup(S){const f=X(),t=S,o=I(null),d=T(()=>{let n={};const a=new Set(t.filterManager.state.folders);return t.folders.map(c=>c.id).forEach(c=>{a.has(c)&&(n[c]=!0)}),n}),u=T(()=>{let n={};return t.folders.map(a=>a.id).forEach(a=>{t.visibleFolders[a]&&(n[a]=!0)}),n}),i=T(()=>{let n={};return t.folders.forEach(a=>{let c=[];d.value[a.id]&&c.push("selected"),n[a.id]=c.join(" ")}),n});function g(n){let a=t.visibleFolders;a[n]?delete a[n]:a[n]=!0}function p(n){let a=new Set(t.filterManager.state.folders);const c=a.has(n),k=f.folders[n].parent!=null&&a.has(f.folders[n].parent);c&&!k?(a.delete(n),ve(n).forEach($=>a.delete($.id))):(l(n,a),a.add(n),ve(n).forEach($=>a.add($.id)),be(f.folders[n]).forEach($=>a.delete($.id))),t.filterManager.setFolders(Array.from(a)),t.filterManager.update(!0)}function l(n,a){const c=be(f.folders[n]);let k;for(let $ of c)if(a.has($.id))k=$;else break;k!=null&&ve(k.id).forEach($=>a.delete($.id))}return(n,a)=>{const c=Se("FolderList2",!0);return s(),r("ul",{class:B(t.root?"tree":""),style:Y(t.root?"padding-left:0px;":"")},[(s(!0),r(E,null,q(S.folders,k=>(s(),r("li",{style:Y(t.root?"padding-left:0px;":""),class:"no-break",onMouseenter:$=>o.value=k.id,onMouseleave:a[0]||(a[0]=$=>o.value=null)},[e("div",Mt,[e("summary",{class:B(i.value[k.id]),onClick:$=>p(k.id)},[J(x(k.name)+" ",1),e("span",It,x(k.count),1)],10,Vt)]),k.children&&k.children.length>0?(s(),r("i",{key:0,onClick:$=>g(k.id),class:B("bi bi-chevron-"+(u.value[k.id]?"down":"right")+" ms-2 btn-icon"),style:{"font-size":"9px"}},null,10,Ft)):y("",!0),e("span",{class:B(o.value===k.id?"visible-option":"invisible-option")},[C(Ct,{folder:k,style:{display:"inline-block"}},null,8,["folder"])],2),k.children&&k.children.length>0&&u.value[k.id]?(s(),V(c,{key:1,folders:k.children,root:!1,"visible-folders":t.visibleFolders,"filter-manager":t.filterManager},null,8,["folders","visible-folders","filter-manager"])):y("",!0)],44,St))),256))],6)}}});const zt=j(Tt,[["__scopeId","data-v-845ce316"]]),Et={class:"text-center"},Ot={class:"w-100 text-center",style:{"font-size":"10px"}},Pt={key:0,class:"progress",role:"progressbar","aria-label":"Example 1px high","aria-valuemin":"0","aria-valuemax":"100",style:{height:"1px"}},Dt=L({__name:"TaskStatus",props:{task:{}},setup(S){const f=S,t=T(()=>f.task.total-f.task.remain-f.task.computing),o=T(()=>f.task.total);return(d,u)=>(s(),r("div",Et,[J(x(f.task.name)+" ",1),e("div",Ot,x(t.value)+" / "+x(o.value)+" "+x(d.$t("main.nav.tasks.done")),1),o.value>0?(s(),r("div",Pt,[e("div",{class:"progress-bar",style:Y(`width: ${t.value/o.value*100}%`)},null,4)])):y("",!0)]))}}),Gt={class:""},Lt={class:"m-0",style:{padding:"4px 0px 4px 8px"}},Rt={class:"d-flex align-items-center",style:{"font-size":"15px","line-height":"14px"}},At={key:0,class:"bi bi-chevron-left"},jt={key:1,class:"bi bi-chevron-right"},Ut={class:"ps-2 pe-2",style:{"padding-bottom":"9.5px"}},Ht={class:"d-flex align-items-center"},Bt={style:{"max-height":"300px",overflow:"auto"}},Nt={key:0,id:"import"},Wt={class:"pt-1 pb-2"},qt={class:"d-flex align-items-center ps-2 pe-2",style:{height:"30px"}},Kt={key:0,class:"ps-2 pe-2"},Qt={class:"p-1"},Yt={key:0,class:"custom-hr"},Xt={class:"p-2 mt-0"},Zt={key:0,class:"d-flex"},Jt={key:0,class:"spinner-grow spinner-grow-sm float-end",style:{width:"10px",height:"10px","margin-top":"5px"}},es={key:1,class:"bb me-1"},ts={class:"bb me-2"},ss={key:1,class:"mt-2"},os={key:0,class:"property-item"},as={class:"p-2 mt-0"},ls={key:1,class:"mt-2"},ns={key:0,class:"property-item"},is=200,rs=55,ds=L({__name:"Menu",emits:["export","toggle"],setup(S,{emit:f}){const t=ae(),o=X(),d=de(),u=t.getTabManager(),i=f,g=I(!1),p=I(!1),l=I(!0),n=T(()=>l.value?is:rs),a=async P=>{d.showModal(te.IMPORT)},c=T(()=>t.backendStatus.tasks.filter(P=>!P.done));function k(){d.showModal(te.FOLDERSELECTION,{callback:$,mode:"images"})}function $(P){P&&o.addFolder(P)}function G(){l.value=!l.value,i("toggle")}return W(()=>t.status.import.to_import,()=>g.value=!0),(P,v)=>{var _;return s(),r("div",{class:"menu overflow-scroll",style:Y({width:n.value+"px"})},[e("div",Gt,[e("div",null,[e("div",Lt,[e("div",Rt,[l.value?(s(),r(E,{key:0},[e("div",{class:"flex-grow-1 text-capitalize overflow-hidden",onClick:v[0]||(v[0]=()=>{})},x((_=m(d).data.status.selectedProject)==null?void 0:_.name),1),C(F,{message:"main.menu.close_project"},{default:h(()=>[e("div",{class:"base-hover p-1",onClick:v[1]||(v[1]=w=>m(d).closeProject())},v[6]||(v[6]=[e("i",{class:"bi bi-arrow-up-left-square red-hover"},null,-1)]))]),_:1}),e("div",{class:"base-hover p-1",onClick:v[2]||(v[2]=w=>m(d).showModal(m(te).SETTINGS))},v[7]||(v[7]=[e("i",{class:"bi bi-gear"},null,-1)]))],64)):y("",!0),e("div",{class:B(["base-hover p-1",l.value?"":"flex-grow-1 text-center"]),style:{"margin-right":"6px"},onClick:G},[l.value?(s(),r("i",At)):(s(),r("i",jt))],2)])]),l.value?(s(),r(E,{key:0},[v[9]||(v[9]=e("div",{class:"custom-hr"},null,-1)),e("div",Ut,[e("div",Ht,[e("div",null,[e("b",null,x(P.$t("main.nav.folders.title")),1)]),e("div",{id:"add_folder",class:"ms-auto plus",onClick:v[3]||(v[3]=w=>{k(),m(_e)()})},[C(F,{message:"main.nav.folders.add"},{default:h(()=>v[8]||(v[8]=[e("i",{class:"bi bi-plus"},null,-1)])),_:1})])]),e("div",Bt,[m(t).getTab()?(s(),V(zt,{key:0,folders:m(o).folderRoots,"filter-manager":m(u).collection.filterManager,"visible-folders":m(u).state.visibleFolders},null,8,["folders","filter-manager","visible-folders"])):y("",!0)])])],64)):y("",!0),l.value?(s(),r(E,{key:1},[c.value&&c.value.length?(s(),r("div",Nt,[v[11]||(v[11]=e("div",{class:"custom-hr"},null,-1)),e("div",Wt,[e("div",qt,[e("div",null,[e("b",null,x(P.$t("main.nav.tasks.title")),1)])]),v[10]||(v[10]=e("div",{class:"custom-hr"},null,-1)),m(t).backendStatus?(s(),r("div",Kt,[(s(!0),r(E,null,q(c.value,(w,b)=>(s(),r("div",Qt,[b?(s(),r("div",Yt)):y("",!0),C(Dt,{task:w},null,8,["task"])]))),256))])):y("",!0)])])):y("",!0)],64)):y("",!0),v[16]||(v[16]=e("div",{class:"custom-hr"},null,-1)),e("div",Xt,[l.value?(s(),r("div",Zt,[C(F,{message:"main.nav.properties.properties_tooltip",pos:"top",icon:!0},{default:h(()=>[e("b",null,x(P.$t("main.nav.properties.title")),1)]),_:1}),v[13]||(v[13]=e("span",{class:"flex-grow-1"},null,-1)),p.value?(s(),r("span",Jt,v[12]||(v[12]=[e("span",{class:"sr-only"},null,-1)]))):(s(),r("span",es,[C(F,{pos:"right",message:"main.nav.properties.import_properties_tooltip"},{default:h(()=>[e("i",{class:"bi bi-box-arrow-in-up text-secondary",style:{position:"relative",top:"0px","font-size":"15px"},onClick:a})]),_:1})])),e("span",ts,[C(F,{pos:"right",message:"main.nav.properties.export_properties_tooltip"},{default:h(()=>[e("i",{class:"bi bi-box-arrow-up text-secondary",style:{position:"relative",top:"0px","font-size":"15px"},onClick:v[4]||(v[4]=w=>m(d).showModal(m(te).EXPORT,void 0))})]),_:1})])])):y("",!0),m(t).status.loaded?(s(),r("div",ss,[(s(!0),r(E,null,q(m(o).properties,w=>(s(),r(E,null,[w.id>=0?(s(),r("div",os,[C(xe,{property:w,open:l.value},null,8,["property","open"])])):y("",!0)],64))),256)),l.value?(s(),r(E,{key:0},[v[15]||(v[15]=e("div",{class:"property-item m-0 p-0"},null,-1)),e("div",{id:"add-property",onClick:v[5]||(v[5]=w=>{m(d).showModal(m(te).PROPERTY,void 0),m(_e)()}),class:"btn-icon base-hover mt-1",style:{"line-height":"25px"}},[v[14]||(v[14]=e("i",{class:"bi bi-plus btn-icon float-start",style:{"font-size":"25px"}},null,-1)),e("span",null,x(P.$t("main.nav.properties.add_property")),1)])],64)):y("",!0)])):y("",!0)]),v[17]||(v[17]=e("div",{class:"custom-hr"},null,-1)),e("div",as,[l.value?(s(),V(F,{key:0,message:"main.nav.computed.computed_tooltip",icon:!0},{default:h(()=>[e("b",null,x(P.$t("main.nav.computed.title")),1)]),_:1})):y("",!0),m(t).status.loaded?(s(),r("div",ls,[(s(!0),r(E,null,q(m(o).properties,w=>(s(),r(E,null,[w.id<0&&w.id!=m(Ge)?(s(),r("div",ns,[C(F,{pos:"bottom",message:"main.nav.computed."+Math.abs(w.id).toString()+"_tooltip"},{default:h(()=>[C(xe,{property:w,open:l.value},null,8,["property","open"])]),_:2},1032,["message"])])):y("",!0)],64))),256))])):y("",!0)])])])],4)}}});const us=j(ds,[["__scopeId","data-v-55b40135"]]),ps={class:"p-0 hover-light ps-1 bb",style:{width:"50px"}},cs={class:""},ms=["onClick"],vs=L({__name:"FilterGroupOperator",props:{modelValue:{}},emits:["update:modelValue"],setup(S,{emit:f}){const t=S,o=f;function d(u){o("update:modelValue",u)}return(u,i)=>(s(),V(se,null,{button:h(()=>[e("div",ps,[e("span",cs,x(u.$t("modals.filters."+t.modelValue)),1)])]),popup:h(({hide:g})=>[e("div",{class:"ps-2 pt-1 pb-1 pe-2",onClick:g},[e("div",{class:"base-btn",onClick:i[0]||(i[0]=p=>d(m(ke).and))},x(u.$t("modals.filters.and")),1),i[2]||(i[2]=e("hr",{class:"m-0 p-0 mt-1 mb-1"},null,-1)),e("div",{class:"base-btn",onClick:i[1]||(i[1]=p=>d(m(ke).or))},x(u.$t("modals.filters.or")),1)],8,ms)]),_:1}))}}),gs=["disabled"],fs={class:"m-0 p-1"},_s=["onClick"],ys=L({__name:"OperatorChoice",props:{propertyId:{},modelValue:{},disabled:{type:Boolean}},emits:["hide","update:modelValue"],setup(S,{emit:f}){const t=X(),o=S,d=f,u=T(()=>t.properties[o.propertyId]),i=T(()=>Le(u.value.type));async function g(p){d("update:modelValue",p)}return(p,l)=>(s(),V(se,{onHide:l[0]||(l[0]=n=>d("hide")),placement:"bottom"},{button:h(()=>[e("div",{class:"text-nowrap sb ps-1 pe-1",disabled:o.disabled},[e("span",null,x(p.$t("modals.filters.operators."+o.modelValue)),1)],8,gs)]),popup:h(({hide:n})=>[e("div",fs,[(s(!0),r(E,null,q(i.value,a=>(s(),r("div",{class:"hover-light p-1 rounded",style:{cursor:"pointer"},onClick:c=>{g(a),n()}},[e("a",null,x(p.$t("modals.filters.operators."+a)),1)],8,_s))),256))])]),_:1}))}});const hs=j(ys,[["__scopeId","data-v-21b8bb8e"]]),bs={class:"d-flex text-nowrap overflow-hidden",style:{"font-size":"14px"}},ks=L({__name:"FilterValueInput",props:{modelValue:{},property:{},width:{}},emits:["update:modelValue"],setup(S,{emit:f}){const t=S,o=f;function d(u){o("update:modelValue",u)}return(u,i)=>(s(),r("div",bs,[m(we)(u.property.type)?(s(),V(Re,{key:0,"model-value":t.modelValue,"onUpdate:modelValue":d,"no-wrap":!0,"auto-focus":!0,"can-create":!1,"can-customize":!1,property:t.property,teleport:!1,width:t.width,class:"sb","force-multi":!0},null,8,["model-value","property","width"])):t.property.type==m(N).color?(s(),V(Ae,{key:1,"model-value":t.modelValue,"onUpdate:modelValue":d,width:t.width,rounded:!0,"min-height":22,teleport:!1,offset:2,class:"sb"},null,8,["model-value","width"])):t.property.type==m(N).number?(s(),V(je,{key:2,"model-value":t.modelValue,"onUpdate:modelValue":d,width:t.width,height:26,"input-offset":0,class:"sb"},null,8,["model-value","width"])):t.property.type==m(N).url?(s(),V(Ue,{key:3,"model-value":t.modelValue,"onUpdate:modelValue":d,width:t.width,offset:-22,class:"sb"},null,8,["model-value","width"])):t.property.type==m(N).checkbox?(s(),V(He,{key:4,"model-value":t.modelValue,"onUpdate:modelValue":d,label:t.property.name,width:t.width,class:"sb"},null,8,["model-value","label","width"])):t.property.type==m(N).date?(s(),V(Be,{key:5,"model-value":t.modelValue,teleport:!1,"onUpdate:modelValue":d,width:t.width,class:"sb"},null,8,["model-value","width"])):(s(),V(Ne,{key:6,"model-value":t.modelValue,"onUpdate:modelValue":d,width:t.width,offset:-22,class:"sb"},null,8,["model-value","width"]))]))}}),$s={class:"p-0 m-0 ps-2"},xs=L({__name:"FilterRow",props:{manager:{},filter:{}},emits:[],setup(S,{emit:f}){const t=X(),o=S,d=T(()=>t.properties[o.filter.propertyId]),u=T(()=>qe(o.filter.operator));function i(l){o.manager.updateFilter(o.filter.id,{operator:l})}function g(l){o.manager.updateFilter(o.filter.id,{value:l})}function p(l){o.manager.updateFilter(o.filter.id,{propertyId:l.id})}return(l,n)=>(s(),r(E,null,[e("td",$s,[C(We,{"model-value":d.value,"onUpdate:modelValue":p},null,8,["model-value"])]),e("td",null,[C(hs,{"property-id":d.value.id,"model-value":o.filter.operator,"onUpdate:modelValue":i},null,8,["property-id","model-value"])]),e("td",null,[u.value?(s(),V(ks,{key:0,"model-value":o.filter.value,"onUpdate:modelValue":g,property:d.value,width:140,style:{width:"150px"},class:""},null,8,["model-value","property"])):y("",!0)])],64))}}),ws={style:{"max-height":"500px",overflow:"auto"}},Fe=L({__name:"AddFilterBtn",props:{group:{},manager:{}},emits:[],setup(S,{emit:f}){const t=S;function o(d){t.manager.addNewFilter(d,t.group.id),ce.filter.show()}return(d,u)=>(s(),V(se,{placement:"auto"},{button:h(()=>[Ke(d.$slots,"default")]),popup:h(({hide:i})=>[e("div",ws,[C(Me,{onSelect:g=>{o(g),i()},"ignore-ids":[m(ye).folders]},null,8,["onSelect","ignore-ids"])])]),_:3}))}}),Cs={class:"filter-group"},Ss={class:"table table-sm"},Ms={style:{height:"33px"}},Vs={class:""},Is={key:0,class:"m-0 p-0"},Fs={key:2,class:"text-secondary"},Ts={class:"border rounded"},zs={class:""},Es=["onClick"],Os={class:"d-flex text-secondary ms-2"},Ps={class:"add-options hover-light"},Ds=L({__name:"FilterGroup",props:{filter:{},manager:{},parent:{}},emits:["delete"],setup(S,{emit:f}){X();const t=S,o=T(()=>t.filter),d=T(()=>o.value.filters),u=T(()=>{let l=255-(o.value.depth+1)*5;return`background: rgb(${l},${l},${l});`});function i(l){t.manager.deleteFilter(l.id)}function g(l){t.manager.addNewFilterGroup(l)}function p(l,n){t.manager.updateFilterGroup(l,n)}return(l,n)=>(s(),r("div",Cs,[e("table",Ss,[(s(!0),r(E,null,q(d.value,(a,c)=>(s(),r("tr",Ms,[e("td",Vs,[c==0?(s(),r("div",Is,x(l.$t("modals.filters.where")),1)):c==1?(s(),V(vs,{key:1,"model-value":o.value.groupOperator,"onUpdate:modelValue":n[0]||(n[0]=k=>p(o.value.id,k))},null,8,["model-value"])):(s(),r("span",Fs,x(l.$t("modals.filters."+o.value.groupOperator)),1))]),a.propertyId!==void 0?(s(),V(xs,{key:0,filter:a,manager:t.manager},null,8,["filter","manager"])):(s(),r("td",{key:1,colspan:"3",style:Y(u.value)},[e("div",Ts,[C(Te,{filter:a,manager:t.manager},null,8,["filter","manager"])])],4)),e("td",zs,[e("span",{class:"base-btn",onClick:k=>i(a)},n[2]||(n[2]=[e("i",{class:"bi bi-trash"},null,-1)]),8,Es)])]))),256))]),e("div",Os,[C(Fe,{group:t.filter,manager:t.manager},{default:h(()=>[e("div",Ps,[n[3]||(n[3]=e("i",{class:"bi bi-plus"},null,-1)),J(x(l.$t("modals.filters.new_filter")),1)])]),_:1},8,["group","manager"]),e("div",{class:"add-options hover-light",onClick:n[1]||(n[1]=a=>g(o.value.id))},[n[4]||(n[4]=e("i",{class:"bi bi-plus"},null,-1)),J(x(l.$t("modals.filters.new_group")),1)])])]))}});const Te=j(Ds,[["__scopeId","data-v-e644f737"]]),Gs={key:0,class:"d-flex flex-row m-0 ms-1 p-1 bg hover-light bg-medium",style:{cursor:"pointer"}},Ls={key:0},Rs={key:0,class:"or-separator"},As={key:0,class:"or-separator"},js={key:0,class:"m-1 p-1"},Us=L({__name:"MainFilterDropdown",props:{manager:he},emits:["update:modelValue"],setup(S,{emit:f}){const t=X(),o=S,d=I(null),u=I(null),i=T(()=>{let p=g(o.manager.state.filter),l={};return p.forEach(n=>l[n.propertyId]=n),Object.values(l)});function g(p){let l=[];for(let n of p.filters)n.isGroup?l.push(...g(n)):l.push(n);return l}return W(()=>o.manager.state.filter.filters,()=>{o.manager.state.filter.filters.length==0&&u.value.hide()}),ne(async()=>{await Z(),ce.filter=u.value}),(p,l)=>(s(),V(se,{ref_key:"dropdownElem",ref:u,placement:"top-start"},{button:h(()=>[e("div",null,[i.value.length||o.manager.state.query?(s(),r("div",Gs,[o.manager.state.query?(s(),r("div",Ls,[l[0]||(l[0]=e("span",{class:"text-primary"},"Text Query",-1)),i.value.length?(s(),r("span",Rs,"|")):y("",!0)])):y("",!0),(s(!0),r(E,null,q(i.value,(n,a)=>(s(),r("div",null,[a>0?(s(),r("span",As,"|")):y("",!0),n.propertyId==m(ye).id?(s(),V(pe,{key:1,type:m(t).properties[n.propertyId].type,style:{"margin-right":"2px"}},null,8,["type"])):y("",!0),e("span",null,x(m(t).properties[n.propertyId].name),1)]))),256))])):y("",!0)])]),popup:h(()=>[e("div",{class:"m-0 p-0",ref_key:"popupElem",ref:d},[Object.keys(m(t).properties).length>0?(s(),r("div",js,[C(Te,{filter:o.manager.state.filter,manager:o.manager,parent:d.value},null,8,["filter","manager","parent"])])):y("",!0)],512)]),_:1},512))}});const Hs=j(Us,[["__scopeId","data-v-56cd3bdb"]]),Bs={class:"d-flex flex-row filter-form"},Ns={class:"pt-1 pb-1"},Ws=L({__name:"FilterForm",props:{manager:he},setup(S){const f=S;return(t,o)=>(s(),r("div",Bs,[e("div",Ns,x(t.$t("main.menu.filters"))+": ",1),C(Hs,{manager:f.manager},null,8,["manager"]),C(Fe,{manager:f.manager,group:f.manager.state.filter,class:"p-1"},{default:h(()=>o[0]||(o[0]=[e("span",{class:"base-hover plus-btn text-secondary"},[e("i",{class:"bi bi-plus"})],-1)])),_:1},8,["manager","group"])]))}});const qs=j(Ws,[["__scopeId","data-v-cc2f25ec"]]),Ks={class:"p-1",style:{"max-height":"400px","overflow-y":"scroll"}},Qs=L({__name:"PropertyDropdown",props:{groupIds:Array},emits:["select"],setup(S,{emit:f}){const t=S,o=f,d=I(null);return(u,i)=>(s(),V(se,{ref_key:"dropdownElem",ref:d,"auto-focus":!1},{button:h(()=>i[2]||(i[2]=[e("div",{class:"text-secondary p-1"},[e("span",{class:"base-hover plus-btn"},[e("i",{class:"bi bi-plus"})])],-1)])),popup:h(()=>[e("div",Ks,[C(Me,{onClick:i[0]||(i[0]=g=>m(_e)()),onSelect:i[1]||(i[1]=g=>{o("select",g),d.value.hide()}),"ignore-ids":t.groupIds},null,8,["ignore-ids"])])]),_:1},512))}});const ze=j(Qs,[["__scopeId","data-v-012e1f38"]]),Ys={class:"base-hover ps-1 pe-1"},Xs={class:"main"},Zs=["onClick"],Js=L({__name:"TimeUnitDropdown",props:{modelValue:{}},emits:["update:modelValue"],setup(S,{emit:f}){const t=S,o=f,d=Object.values(Ve);function u(i){o("update:modelValue",i)}return(i,g)=>(s(),V(se,null,{button:h(()=>[e("div",Ys,x(t.modelValue),1)]),popup:h(({hide:p})=>[e("div",Xs,[(s(!0),r(E,null,q(m(d),l=>(s(),r("div",{class:"base-hover option",onClick:n=>{u(l),p()}},x(l),9,Zs))),256))])]),_:1}))}});const eo=j(Js,[["__scopeId","data-v-ce3e3774"]]),to={class:""},so={class:"d-flex ipt"},oo={class:"ms-2",min:"1"},ao=L({__name:"GroupOptionDropdown",props:{option:{}},emits:["change"],setup(S,{emit:f}){const t=S,o=f,d=I(1),u=I(Ve.Year);function i(){t.option.stepSize==d.value&&t.option.stepUnit==u.value||o("change",{stepSize:d.value,stepUnit:u.value})}function g(){d.value=t.option.stepSize??1,u.value=t.option.stepUnit}return W(()=>t.option,g),ne(g),W(d,()=>{(d.value<1||d.value==null||isNaN(d.value))&&(d.value=1)}),(p,l)=>(s(),V(se,{onHide:i},{button:h(()=>l[2]||(l[2]=[e("i",{class:"bi bi-three-dots-vertical"},null,-1)])),popup:h(({hide:n,focus:a})=>[e("div",to,[e("div",so,[e("div",null,[re(e("input",{type:"number","onUpdate:modelValue":l[0]||(l[0]=c=>d.value=c)},null,512),[[me,d.value]])]),e("div",oo,[C(eo,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=c=>u.value=c),onHide:a},null,8,["modelValue","onHide"])])])])]),_:1}))}});const lo=j(ao,[["__scopeId","data-v-78b647dc"]]),no={class:"d-flex flex-row group-form"},io={class:"pt-1 pb-1"},ro={key:0,class:"bg-medium bg d-flex flex-row m-0 ms-1 p-0 align-items-center"},uo={key:0,class:"bi bi-chevron-right smaller"},po=["onClick"],co=["onClick"],mo=["onClick"],vo=["onClick"],go=["onClick"],fo=["onClick"],_o=["onClick"],yo=["onClick"],ho=["onClick"],bo={key:5,class:"sm-btn"},ko={key:0,class:"spinner-grow spinner-grow-sm loading ms-1"},$o=L({__name:"GroupForm",props:{isLoading:Boolean,manager:Qe},setup(S){const f=X(),t=S;function o(n){t.manager.setGroupOption(n),t.manager.update(!0)}function d(n){t.manager.delGroupOption(n),t.manager.update(!0)}function u(n,a){t.manager.setGroupOption(n,{direction:a}),t.manager.sortGroups(!0)}function i(n,a){t.manager.setGroupOption(n,{type:a}),t.manager.sortGroups(!0)}function g(n,a){t.manager.setGroupOption(n,a),t.manager.update(!0)}const p=T(()=>t.manager.state.groupBy.map(n=>f.properties[n])),l=T(()=>{const n=[];return t.manager.state.groupBy.forEach(a=>{n.push({option:t.manager.state.options[a],property:f.properties[a]})}),n});return(n,a)=>(s(),r("div",no,[e("div",io,x(n.$t("main.menu.groupby"))+": ",1),p.value.length?(s(),r("div",ro,[(s(!0),r(E,null,q(l.value,(c,k)=>(s(),r(E,null,[k>0?(s(),r("i",uo)):y("",!0),e("div",{class:"base-hover m-1 ps-1 pe-1",onClick:$=>d(c.property.id),id:"remove-group-button"},x(c.property.name),9,po),c.option.type==m(oe).Size?(s(),V(F,{key:1,message:"main.menu.sort.group_order_nb_tooltip"},{default:h(()=>[c.option.direction==m(ee).Ascending?(s(),r("i",{key:0,class:"bi bi-sort-up-alt sm-btn",onClick:$=>i(c.property.id,m(oe).Property)},null,8,co)):(s(),r("i",{key:1,class:"bi bi-sort-down sm-btn",onClick:$=>i(c.property.id,m(oe).Property)},null,8,mo))]),_:2},1024)):(s(),V(F,{key:2,message:"main.menu.sort.group_order_az_tooltip"},{default:h(()=>[c.property.type==m(N).number?(s(),r(E,{key:0},[c.option.direction==m(ee).Ascending?(s(),r("i",{key:0,class:"bi bi-sort-numeric-up sm-btn",onClick:$=>i(c.property.id,m(oe).Size)},null,8,vo)):(s(),r("i",{key:1,class:"bi bi-sort-numeric-down-alt sm-btn",onClick:$=>i(c.property.id,m(oe).Size)},null,8,go))],64)):(s(),r(E,{key:1},[c.option.direction==m(ee).Ascending?(s(),r("i",{key:0,class:"bi bi-sort-alpha-up sm-btn",onClick:$=>i(c.property.id,m(oe).Size)},null,8,fo)):(s(),r("i",{key:1,class:"bi bi-sort-alpha-down-alt sm-btn",onClick:$=>i(c.property.id,m(oe).Size)},null,8,_o))],64))]),_:2},1024)),c.option.direction==m(ee).Ascending?(s(),V(F,{key:3,message:"main.menu.sort.order_asc"},{default:h(()=>[e("i",{class:"bi bi-arrow-up sm-btn",onClick:$=>u(c.property.id,m(ee).Descending)},null,8,yo)]),_:2},1024)):(s(),V(F,{key:4,message:"main.menu.sort.order_desc"},{default:h(()=>[e("i",{class:"bi bi-arrow-down sm-btn",onClick:$=>u(c.property.id,m(ee).Ascending)},null,8,ho)]),_:2},1024)),c.property.type==m(N).date?(s(),r("div",bo,[C(lo,{option:c.option,onChange:$=>g(c.property.id,$)},null,8,["option","onChange"])])):y("",!0)],64))),256)),t.isLoading?(s(),r("i",ko)):y("",!0)])):y("",!0),C(ze,{id:"add-group-button","group-ids":t.manager.state.groupBy,onSelect:a[0]||(a[0]=c=>o(c))},null,8,["group-ids"])]))}});const xo=j($o,[["__scopeId","data-v-dcec9b5d"]]),wo={class:"d-flex flex-row sort-form"},Co={class:"pt-1 pb-1"},So={key:0,class:"d-flex flex-row m-0 p-0 bg-medium bg ms-1 align-items-center"},Mo={key:0,class:"bi bi-chevron-right smaller"},Vo=["onClick"],Io=["onClick"],Fo=["onClick"],To=L({__name:"SortForm",props:{manager:Ye},setup(S){const f=X(),t=S,o=T(()=>t.manager.state.sortBy.map(p=>({propertyId:p,direction:t.manager.state.options[p].direction}))),d=T(()=>o.value.map(p=>p.propertyId));function u(p){t.manager.setSort(p),t.manager.update(!0)}function i(p){t.manager.delSort(p),t.manager.update(!0)}function g(p,l){t.manager.setSort(p,{direction:l}),t.manager.update(!0)}return(p,l)=>(s(),r("div",wo,[e("div",Co,x(p.$t("main.menu.sort.title"))+": ",1),o.value.length?(s(),r("div",So,[(s(!0),r(E,null,q(o.value,(n,a)=>(s(),r(E,null,[a>0?(s(),r("i",Mo)):y("",!0),e("div",{class:"me-0 ms-1 ps-1 mt-1 mb-1 pe-1 base-hover",onClick:c=>i(n.propertyId)},x(m(f).properties[n.propertyId].name),9,Vo),n.direction==m(ee).Ascending?(s(),V(F,{key:1,message:"main.menu.sort.order_asc"},{default:h(()=>[e("i",{class:"bi bi-arrow-up sm-btn",onClick:c=>g(n.propertyId,m(ee).Descending)},null,8,Io)]),_:2},1024)):(s(),V(F,{key:2,message:"main.menu.sort.order_desc"},{default:h(()=>[e("i",{class:"bi bi-arrow-down sm-btn",onClick:c=>g(n.propertyId,m(ee).Ascending)},null,8,Fo)]),_:2},1024))],64))),256))])):y("",!0),C(ze,{"group-ids":d.value,onSelect:l[0]||(l[0]=n=>u(n))},null,8,["group-ids"])]))}});const zo=j(To,[["__scopeId","data-v-4e00ef99"]]),Eo={class:"custom-slider"},Oo=["value","min","max","step"],Po=L({__name:"RangeInput",props:{min:{default:0},max:{default:1},step:{default:.1},modelValue:{}},emits:["update:modelValue"],setup(S,{emit:f}){const t=S,o=f,d=I(t.modelValue),u=I(null),i=(n,a,c)=>(n-a)/(c-a),g=n=>{u.value.style.setProperty("--ProgressPercent",`${n}%`)};Xe(()=>{if(u.value){const n=i(d.value,u.value.min,u.value.max);g(n+0)}});function p(){o("update:modelValue",d.value)}let l=!1;return navigator.userAgent.indexOf("AppleWebKit")!=-1&&(l=!0),W(()=>t.modelValue,()=>d.value=t.modelValue),(n,a)=>(s(),r("div",Eo,[e("input",{ref_key:"slider",ref:u,value:d.value,onInput:a[0]||(a[0]=({target:c})=>d.value=parseFloat(c.value)),type:"range",min:n.min,max:n.max,step:n.step,class:"slider",style:Y(m(l)?"top:-5px":""),onChange:p},null,44,Oo)]))}});const Do=j(Po,[["__scopeId","data-v-5269b272"]]),Go={class:"p-2"},Lo={key:0,class:"border mb-1 p-1 text-center text-secondary",style:{"background-color":"#f7f7f7"}},Ro={class:"border mb-1 p-1"},Ao={class:"me"},jo={key:0},Uo={key:1},Ho={class:"border mb-1 p-1",style:{"background-color":"#f7f7f7"}},Bo={class:"d-flex center justify-content-center"},No={key:1,class:"bi bi-arrow-down text-secondary"},Wo={key:3,class:"bi bi-arrow-up text-secondary"},qo={class:"border mb-1 p-1"},Ko={class:"me"},Qo={key:0},Yo={key:1},Xo={key:1,class:"border mb-1 p-1 text-center text-secondary",style:{"background-color":"#f7f7f7"}},le=5,Zo=L({__name:"HistoryDropdown",emits:[],setup(S,{emit:f}){const t=X(),o=I(!1),d=T(()=>o.value?{backgroundColor:"blue"}:{backgroundColor:"white"}),u=T(()=>[...t.history.undo].reverse().slice(0,le)),i=T(()=>t.history.redo.slice(Math.max(t.history.redo.length-le,0)));return W(()=>t.onUndo,()=>{console.log("changed"),o.value=!0,setTimeout(()=>o.value=!1,100)}),(g,p)=>u.value.length||i.value.length?(s(),V(se,{key:0},{button:h(()=>[C(F,{message:"dropdown.history.info"},{default:h(()=>[e("div",{class:"d-flex sb flash",style:Y([{"font-size":"14px"},d.value])},[p[2]||(p[2]=e("i",{class:"bi bi-clock-history me-1"},null,-1)),e("div",null,x(g.$t("dropdown.history.button")),1)],4)]),_:1})]),popup:h(()=>[e("div",Go,[m(t).history.redo.length>le?(s(),r("div",Lo," + "+x(m(t).history.redo.length-le),1)):y("",!0),(s(!0),r(E,null,q(i.value,l=>(s(),r("div",Ro,[e("span",Ao,x(new Date(l.timestamp).toLocaleTimeString("fr-Fr",{hour:"2-digit",minute:"2-digit"})),1),p[3]||(p[3]=e("span",{class:"sep ms-1 me-1"},null,-1)),l.tags?(s(),r("span",jo,x(l.tags)+" "+x(g.$t("dropdown.history.tags")),1)):y("",!0),l.values?(s(),r("span",Uo,x(l.values)+" "+x(g.$t("dropdown.history.values")),1)):y("",!0)]))),256)),e("div",Ho,[e("div",Bo,[u.value.length?(s(),V(F,{key:0,message:"dropdown.history.undo"},{default:h(()=>[e("div",{class:"bi bi-arrow-down sb",onClick:p[0]||(p[0]=(...l)=>m(t).undo&&m(t).undo(...l))})]),_:1})):(s(),r("div",No)),p[4]||(p[4]=e("div",{style:{width:"30px"}},null,-1)),i.value.length?(s(),V(F,{key:2,message:"dropdown.history.redo"},{default:h(()=>[e("div",{class:"bi bi-arrow-up sb",onClick:p[1]||(p[1]=(...l)=>m(t).redo&&m(t).redo(...l))})]),_:1})):(s(),r("div",Wo))])]),(s(!0),r(E,null,q(u.value,l=>(s(),r("div",qo,[e("span",Ko,x(new Date(l.timestamp).toLocaleTimeString("fr-Fr",{hour:"2-digit",minute:"2-digit"})),1),p[5]||(p[5]=e("span",{class:"sep ms-1 me-1"},null,-1)),l.tags?(s(),r("span",Qo,x(l.tags)+" "+x(g.$t("dropdown.history.tags")),1)):y("",!0),l.values?(s(),r("span",Yo,x(l.values)+" "+x(g.$t("dropdown.history.values")),1)):y("",!0)]))),256)),m(t).history.undo.length>le?(s(),r("div",Xo," + "+x(m(t).history.undo.length-le),1)):y("",!0)])]),_:1})):y("",!0)}});const Jo=j(Zo,[["__scopeId","data-v-85cd80d0"]]),ea=L({__name:"ToggleReload",emits:[],setup(S,{emit:f}){const t=ae(),o=T(()=>t.getTab().autoReload?2:t.getTabManager().collection.state.isDirty?0:1);function d(){o.value==0?t.getTabManager().collection.update():o.value==1?(t.getTab().autoReload=!0,t.updateTabs()):(t.getTab().autoReload=!1,t.updateTabs())}return(u,i)=>(s(),r("div",{class:"bb font",onClick:d,style:{width:"26px",height:"30px",overflow:"hidde"}},[o.value==0?(s(),V(F,{key:0,message:"btn.reload.dirty",pos:"bottom"},{default:h(()=>i[0]||(i[0]=[e("span",{class:"bi bi-arrow-repeat text-warning"},null,-1)])),_:1})):y("",!0),o.value==1?(s(),V(F,{key:1,message:"btn.reload.valid",pos:"bottom"},{default:h(()=>i[1]||(i[1]=[e("span",{class:"bi bi-check2-all text-success"},null,-1)])),_:1})):y("",!0),o.value==2?(s(),V(F,{key:2,message:"btn.reload.auto",pos:"bottom"},{default:h(()=>i[2]||(i[2]=[e("div",{style:{height:"30px"}},[e("span",{class:"bi bi-check2-all text-success small-valid"}),e("span",{class:"bi bi-arrow-repeat big-arrow text-warning",style:{opacity:"0.3"}})],-1)])),_:1})):y("",!0)]))}});const ta=j(ea,[["__scopeId","data-v-61c9799b"]]),sa={class:"d-flex flex-row p-2"},oa=["placeholder"],aa={class:"me-5 d-flex"},la={class:"ms-5",style:{"font-size":"13px"}},na=["checked"],ia={class:"ms-1"},ra={class:"ms-4"},da={class:"d-flex flex-wrap content-container ps-2"},ua=L({__name:"ContentFilter",props:{tab:Ze,computeStatus:Object},emits:["compute-ml","search-images","remove:selected"],setup(S,{emit:f}){const t=S,o=I(""),d=T(()=>Object.keys(t.tab.collection.groupManager.selectedImages.value).map(Number)),u=T(()=>d.value.length);function i(n){const a=n.target.checked;t.tab.collection.groupManager.setSha1Mode(a,!0)}function g(){o.value=t.tab.state.filterState.query}function p(){t.tab.collection.filterManager.setQuery(o.value),t.tab.collection.filterManager.update(!0)}function l(){t.tab.collection.filterManager.setQuery(""),t.tab.collection.filterManager.update(!0)}return ne(g),W(()=>t.tab.collection.filterManager.state.query,g),(n,a)=>(s(),r(E,null,[e("div",sa,[C(F,{icon:!0,message:"main.menu.search_tooltip",iconPos:"left"},{default:h(()=>[e("div",{class:B(["d-flex flex-row search-input me-5",o.value?"border-primary":""])},[a[6]||(a[6]=e("div",{class:"bi bi-search float-start bi-sm"},null,-1)),re(e("input",{type:"text",class:"input-hidden",placeholder:n.$t("main.menu.search"),"onUpdate:modelValue":a[0]||(a[0]=c=>o.value=c),onChange:p},null,40,oa),[[me,o.value]]),e("div",{class:"bi-sm base-hover",style:{cursor:"pointer",padding:"0px 2px"},onClick:l},"x")],2)]),_:1}),e("div",aa,[C(F,{message:"main.menu.grid_tooltip"},{default:h(()=>[e("i",{class:B("bi bi-grid-3x3-gap-fill me-2 btn-icon"+(t.tab.state.display=="tree"?"":" text-secondary")),onClick:a[1]||(a[1]=c=>t.tab.state.display="tree")},null,2)]),_:1}),C(F,{message:"main.menu.table_tooltip"},{default:h(()=>[e("i",{id:"toot",class:B("bi bi-table btn-icon me-2"+(t.tab.state.display=="grid"?"":" text-secondary")),onClick:a[2]||(a[2]=c=>t.tab.state.display="grid")},null,2)]),_:1}),C(F,{message:"main.menu.graph_tooltip"},{default:h(()=>[e("i",{id:"toot",class:B("bi bi-bar-chart btn-icon"+(t.tab.state.display=="graph"?"":" text-secondary")),onClick:a[3]||(a[3]=c=>t.tab.state.display="graph")},null,2)]),_:1})]),C(F,{message:"main.menu.image_size_tooltip",click:!1},{default:h(()=>a[7]||(a[7]=[e("div",{class:"bi bi-aspect-ratio me-1"},null,-1)])),_:1}),e("div",null,[C(Do,{min:30,max:500,modelValue:t.tab.state.imageSize,"onUpdate:modelValue":a[4]||(a[4]=c=>t.tab.state.imageSize=c)},null,8,["modelValue"])]),e("div",la,[C(F,{message:"main.menu.image_mode_tooltip"},{default:h(()=>[e("input",{type:"checkbox",checked:t.tab.collection.groupManager.state.sha1Mode,onChange:i},null,40,na),e("span",ia,x(n.$t("main.menu.image_mode")),1)]),_:1})]),e("div",ra,[C(Jo)]),u.value?(s(),V(Je,{key:0,id:"selection-stamp",class:"ms-5","selected-images-ids":d.value,"onRemove:selected":a[5]||(a[5]=c=>t.tab.collection.groupManager.clearSelection())},null,8,["selected-images-ids"])):y("",!0),a[9]||(a[9]=e("div",{class:"flex-grow-1"},null,-1)),C(F,{message:"main.menu.issue",class:"bb"},{default:h(()=>a[8]||(a[8]=[e("a",{href:"https://github.com/CERES-Sorbonne/Panoptic/issues/new/choose",target:"_blank",class:"bi bi-cone-striped",style:{color:"grey"}},null,-1)])),_:1})]),e("div",da,[C(ta,{class:"me-1"}),C(qs,{manager:t.tab.collection.filterManager},null,8,["manager"]),C(xo,{"is-loading":t.computeStatus.groups,manager:t.tab.collection.groupManager},null,8,["is-loading","manager"]),C(zo,{manager:t.tab.collection.sortManager},null,8,["manager"])])],64))}});const pa=j(ua,[["__scopeId","data-v-3f54024a"]]),ca={class:""},ma={class:"d-flex flex-row"},va=L({__name:"ImageRecomended",props:{pile:Object,size:{type:Number,default:100}},emits:["accept","refuse"],setup(S,{emit:f}){const t=de(),o=S,d=f,u=T(()=>`width: ${o.size}px; height: ${o.size}px;`);T(()=>`max-width: ${o.size-2}px; max-height: ${o.size-1}px;`);const i=T(()=>o.pile.images[0]);return(g,p)=>(s(),r("div",ca,[C(tt,{image:i.value},{default:h(()=>[e("div",{style:Y(u.value),class:"img-container",onClick:p[0]||(p[0]=l=>m(t).showModal(m(te).IMAGE,{image:i.value}))},[C(et,{image:i.value,width:o.size-2,height:o.size-1},null,8,["image","width","height"])],4)]),_:1},8,["image"]),e("div",ma,[C(F,{message:"main.recommand.accept"},{default:h(()=>[e("div",{style:Y(["width: "+o.size/2+"px;",{"font-size":"10px"}]),class:"text-center text-success validate clickable unselectable",onClick:p[1]||(p[1]=l=>d("accept",i.value))}," ✓ ",4)]),_:1}),C(F,{message:"main.recommand.refuse"},{default:h(()=>[e("div",{style:Y(["width: "+o.size/2+"px;",{"font-size":"10px"}]),class:"text-center text-danger refuse clickable unselectable",onClick:p[2]||(p[2]=l=>d("refuse",i.value))}," ✕ ",4)]),_:1})])]))}});const ga=j(va,[["__scopeId","data-v-2ff8fded"]]),fa={class:"reco-container"},_a={class:"d-flex flex-row m-0 ps-2 center mb-1 mt-0",style:{height:"25px"}},ya={key:0,class:"bi bi-funnel-fill bb text-primary"},ha={key:1,class:"bi bi-funnel bb"},ba={class:"text-secondary me-2"},ka={style:{"padding-top":"2px"},class:"me-1"},$a={class:"flex-grow-1"},xa={class:"d-flex flex-row"},wa={key:0,class:"separator"},Ca={class:"d-flex flex-row"},ge=10,Sa=L({__name:"RecommendedMenu",props:{imageSize:{},group:{},width:{},height:{}},emits:["scroll","close","update"],setup(S,{emit:f}){const t=ae(),o=X(),d=st(),u=S,i=f,g=I(1),p=ie([]),l=I(null),n=ie([]),a=ie(new Set),c=I(!0);function k(b){const M=l.value;M.isSha1Group?M.images=M.images.filter(O=>O.sha1!=b.sha1):M.images=M.images.filter(O=>O.id!=b.id),l.value=M,P()}async function $(b){const M=[],O=[];n.forEach(U=>{if(U.value!=null){const R=o.properties[U.propertyId];let H=U.value;R.type==N.multi_tags?(H=b.properties[U.propertyId]??[],H=[...H,U.value]):R.type==N.tag&&(H=[H]),R.mode==fe.id?O.push({instanceId:b.id,propertyId:R.id,value:H}):M.push({propertyId:R.id,sha1:b.sha1,value:H})}}),await o.setPropertyValues(O,M),k(b)}function G(b){l.value.isSha1Group?l.value.images.filter(M=>M.sha1==b.sha1).forEach(M=>a.add(M.id)):a.add(b.id),k(b)}function P(){p.length=0;let b=[];const M=l.value.images;if(l.value.isSha1Group){const O={},U=Array.from(new Set(M.map(R=>R.sha1)));U.forEach(R=>O[R]=[]),M.forEach(R=>O[R.sha1].push(R)),U.forEach(R=>b.push({sha1:R,images:o.sha1Index[R]}))}else M.forEach(O=>b.push({sha1:O.sha1,images:[O]}));v(b,p,g.value,u.imageSize,u.width)}function v(b,M,O,U,R){let H=R,Q=[],D=0;for(let z=0;z<b.length&&!(M.length>=O);z++){let K=b[z];if(K.images=K.images.filter(Ee=>!a.has(Ee.id)),K.images.length==0)continue;let ue=U+ge;if(D+ue<H){Q.push(K),D+=ue;continue}if(Q.length==0)throw new Error("Images seems to be to big for the line");M.push(Q),M.length<O&&(Q=[K],D=ue)}Q.length>0&&M.length<O&&M.push(Q)}async function _(){if(!u.group||!d.hasSimilaryFunction)return;const b=d.defaultActions.similar,M=d.getContext(b);M.instanceIds=u.group.images.map(Q=>Q.id);const O=await d.getSimilarImages(M);if(!O)return;if(!O.groups)throw new Error("No instances in ActionResult");let R=ot(O.groups)[0];if(c.value){const Q=new Set(t.getTabManager().collection.filterManager.result.images.map(D=>D.id));R.images=R.images.filter(D=>Q.has(D.id))}R.scores&&at(R),l.value=R,n.length=0;let H=u.group;for(;H;)n.push(...H.meta.propertyValues),H=H.parent;a.clear(),P(),i("update")}function w(){c.value=!c.value}return ne(_),W(()=>u.group,()=>{_(),a.clear()}),W(()=>u.imageSize,P),W(()=>u.width,P),W(c,_),(b,M)=>(s(),r("div",fa,[e("div",_a,[e("div",{class:"text-secondary pe-1",onClick:M[0]||(M[0]=O=>i("close"))},M[2]||(M[2]=[e("span",{class:"bi bi-x-lg bb",style:{}},null,-1)])),M[4]||(M[4]=e("div",{class:"b-left pe-1"},null,-1)),e("div",{class:"text-secondary pe-1",onClick:M[1]||(M[1]=O=>i("scroll",u.group.id))},M[3]||(M[3]=[e("span",{class:"bi bi-arrow-down-circle bb"},null,-1)])),M[5]||(M[5]=e("div",{class:"b-left pe-1"},null,-1)),e("div",{class:"text-secondary pe-1",onClick:w},[c.value?(s(),r("span",ya)):(s(),r("span",ha))]),M[6]||(M[6]=e("div",{class:"b-left pe-1"},null,-1)),C(F,{"icon-pos":"left",message:"main.recommand.tooltip",icon:!0},{default:h(()=>[e("span",ba,x(b.$t("main.recommand.title")),1)]),_:1}),e("div",ka,[C(lt,{action:"similar",onChanged:_})]),e("div",$a,[e("div",xa,[(s(!0),r(E,null,q(n,(O,U)=>(s(),r(E,null,[C(nt,{class:"",value:O},null,8,["value"]),U<n.length-1?(s(),r("div",wa)):y("",!0)],64))),256))])])]),e("div",{style:Y("margin-left:"+ge+"px;")},[(s(!0),r(E,null,q(p,O=>(s(),r("div",null,[e("div",Ca,[(s(!0),r(E,null,q(O,U=>(s(),V(ga,{pile:U,size:u.imageSize,onAccept:$,onRefuse:G,style:Y("margin-right:"+ge+"px;")},null,8,["pile","size","style"]))),256))])]))),256))],4)]))}});const Ma=j(Sa,[["__scopeId","data-v-dcbdfe63"]]);const Va={style:{display:"flex"}},Ia={class:"info"},Fa={__name:"LineChart",props:{chartData:{series:Array,xValues:Array,dataType:N},height:String},setup(S){const f=S,t=I(0),o=I(!1),d={};Object.keys(f.chartData.series).forEach(a=>{d[a]=!1});const u=I({markers:{size:7},legend:{showForSingleSeries:!0,onItemClick:{toggleDataSeries:!1}},xaxis:{type:f.chartData.dataType===N.date?"datetime":"numeric",categories:f.chartData.xValues},chart:{type:"area",stacked:!1,stackOnlyBar:!1,zoom:{type:"x",autoScaleYaxis:!0},animations:{animateGradually:{enabled:!1,delay:150}}},dataLabels:{enabled:!1},stroke:{curve:"straight"},tooltip:{intersect:!0,shared:!1,custom:function({series:a,seriesIndex:c,dataPointIndex:k,w:$}){const G=f.chartData.series[c].data[k];let P='<div style="display: grid; grid-template-columns: repeat(5, 1fr); grid-gap: 5px;">';G.images.forEach((_,w)=>{w<10&&(P+=`<div style="width: 75px; height: 75px;"><img src="${_}" style="width: 100%; height: 100%;" /></div>`)}),P+="</div>";let v=`<span style="display: flex; align-items: center; justify-content: center;min-height:40px"><b>${f.chartData.series[c].name} — </b> ${G.y} Images</span>`;return v+=`<div>${P}</div>`,v}}}),i=()=>{u.value.chart.stacked=!u.value.chart.stacked,o.value=!o.value,t.value+=1},g=()=>{let a;u.value.chart.type==="area"?a={chart:{...u.value.chart,type:"bar"}}:a={chart:{...u.value.chart,type:"area"}},u.value={...u.value,...a},t.value+=1},p=(a,c,k)=>{const G=f.chartData.series[c];let P=Math.max(...G.data.map(v=>v.y));if(document.querySelectorAll(".apexcharts-custom-image").forEach(v=>v.remove()),d[c]){d[c]=!1;return}G.data.forEach((v,_)=>{const b=Math.floor(v.y/P*17),M=v.images.slice(0,b),O=`circle[index="${c}"][j="${_}"]`,U=document.querySelector(O),R=parseFloat(U.getAttribute("cx"));M.forEach((H,Q)=>{const D=document.createElement("img");D.src=H,D.width=40,D.height=40,D.style.position="absolute";let z=R+40/1.5,K=65+Q*40;D.style.left=`${z}px`,D.style.bottom=`${K}px`,D.classList.add("apexcharts-custom-image"),D.addEventListener("mouseover",ue=>l(z,K,H)),D.addEventListener("mouseout",n),a.el.appendChild(D)})}),Object.keys(d).forEach(v=>d[v]=!1),d[c]=!0};function l(a,c,k){const $=document.getElementById("zoomed-image");$.style.left=`${a+120*1.5}px`,$.src=k,$.style.bottom=`${c}px`,$.style.display="block"}function n(){const a=document.getElementById("zoomed-image");a.style.display="none"}return console.log("test"),(a,c)=>{const k=Se("apexchart");return s(),r(E,null,[e("div",Va,[e("button",{class:"mt-2",onClick:g},x(u.value.chart.type==="area"?a.$t("main.graph-view.histo"):a.$t("main.graph-view.curve")),1),f.chartData.series.length>1?(s(),r("button",{key:0,class:"mt-2",style:{"margin-left":"1em"},onClick:i},x(o.value?a.$t("main.graph-view.over"):a.$t("main.graph-view.stack")),1)):y("",!0)]),(s(),V(k,{style:{position:"relative"},key:t.value,height:f.height,type:u.value.chart.type,options:u.value,series:f.chartData.series,onLegendClick:p},null,8,["height","type","options","series"])),e("i",Ia,x(a.$t("main.graph-view.info")),1),c[0]||(c[0]=e("img",{id:"zoomed-image",style:{display:"none",position:"absolute","z-index":"1000",width:"120px",height:"120px","pointer-events":"none"}},null,-1))],64)}}},Ta={key:1},za=L({__name:"GraphView",props:{collection:{},height:{}},emits:[],setup(S,{emit:f}){const t=X(),o=S,d=I(""),u=I(g());function i(){const p=new Set;let l=o.collection.groupManager.getGroupIterator();for(;l;){const n=l.group;if(n.id===0||n.meta.propertyValues&&n.meta.propertyValues[0].value==null){l=l.nextGroup();continue}for(let a of n.children)p.add(a.meta.propertyValues[0].value);n.children.forEach(()=>l=l.nextGroup()),l=l.nextGroup()}return p}function g(){const p={};let l,n=o.collection.groupManager.state.groupBy;if(n.length===0){d.value="Choose at least one date or numeric value to group the images by";return}const a=t.properties[n[0]],c=a.type;if(n.length>2){d.value="Only max two levels of grouping are supported";return}else if(n.length===1)p[a.name]={name:a.name,data:[]};else if(l=Array.from(i()),l.length>20){d.value="Too many curves to draw, select a subgrouping with less than 20 possible values";return}if(c!==N.number&&c!==N.date){d.value="First level of grouping needs to be a date or a numeric property";return}let k=o.collection.groupManager.getGroupIterator();const $=[];for(;k;){const G=k.group;if(G.id===0||G.meta.propertyValues&&G.meta.propertyValues[0].value==null){k=k.nextGroup();continue}let P=G.meta.propertyValues[0];const v=c===N.date?new Date(P.value).getTime():P.value;if($.push(v),a.name in p)p[a.name].data.push({x:v,y:G.images.length,images:G.images.slice(0,20).map(_=>_.urlSmall)});else{const _=G.children.map(b=>b.meta.propertyValues[0].value),w=l.filter(b=>!_.includes(b));for(let b of G.children){const M=b.meta.propertyValues[0].value;if(p[M]===void 0){let O=M;M in t.tags&&(O=t.tags[M].value),p[M]={data:[],name:O}}p[b.meta.propertyValues[0].value].data.push({x:v,y:b.images.length,images:b.images.slice(0,20).map(O=>O.urlSmall)})}for(let b of w){if(p[b]===void 0){let M=b;b in t.tags&&(M=t.tags[b].value),p[b]={data:[],name:M}}p[b].data.push({x:v,y:0,images:[]})}G.children.forEach(()=>k=k.nextGroup())}k=k.nextGroup()}return d.value="",{series:Object.values(p),xValues:$,dataType:c}}return o.collection.groupManager.onChange.addListener(()=>u.value=g()),(p,l)=>(s(),r("div",{class:"",style:Y({height:o.height+"px"})},[d.value===""?(s(),V(Fa,{key:0,chartData:u.value,height:o.height-50+"px"},null,8,["chartData","height"])):(s(),r("span",Ta,x(d.value),1))],4))}}),Ea={key:0,class:"m-0 p-0"},Oa={key:0,style:{"margin-left":"10px"}},Pa=L({__name:"MainView",props:{tabId:{},height:{},filterOpen:{type:Boolean}},setup(S,{expose:f}){const t=ae(),o=t.getTabManager(),d=S;f({updateScrollerWidth:v});const u=I({}),i=I(!0),g=I(null),p=I(null),l=I(null),n=I(0),a=I(0),c=ie({groups:!1}),k=T(()=>o.getVisibleProperties());function $(){g.value&&p.value?n.value=d.height-g.value.clientHeight-p.value.clientHeight-5:g.value?n.value=d.height-g.value.clientHeight-5:n.value=0}o.collection.groupManager.onChange.addListener(()=>{l.value&&o.state.display=="tree"&&l.value.computeLines()});function G(_){u.value=o.collection.groupManager.result.index[_],Z(()=>$())}function P(){u.value={},Z(()=>$())}async function v(){var _;await Z(),a.value=((_=g.value)==null?void 0:_.clientWidth)??a.value}return ne(()=>{a.value=g.value.clientWidth,window.addEventListener("resize",v)}),Ie(()=>{window.removeEventListener("resize",v)}),W(()=>o.state.imageSize,()=>Z($)),W(()=>d.filterOpen,()=>Z($)),W(()=>d.height,async()=>{await Z($)}),W(o.state,_=>{t.updateTabs()},{deep:!0}),W(()=>d.tabId,async()=>{i.value=!1,await Z(),i.value=!0}),(_,w)=>(s(),r(E,null,[e("div",{id:"main-content",ref_key:"filterElem",ref:g},[d.filterOpen?(s(),V(pa,{key:0,tab:m(o),"compute-status":c},null,8,["tab","compute-status"])):y("",!0)],512),e("div",{ref_key:"boxElem",ref:p,class:"m-0 p-0"},[u.value.id?(s(),r("div",Ea,[C(Ma,{group:u.value,"image-size":m(o).state.imageSize,width:a.value,height:50,onClose:P,onScroll:l.value.scrollTo,onUpdate:w[0]||(w[0]=b=>Z(()=>$()))},null,8,["group","image-size","width","onScroll"])])):y("",!0)],512),a.value>0&&n.value>0&&i.value?(s(),r("div",Oa,[m(o).state.display=="tree"?(s(),V(it,{key:0,"group-manager":m(o).collection.groupManager,"image-size":m(o).state.imageSize,height:n.value-0,properties:k.value,"hide-if-modal":!0,"selected-images":m(o).collection.groupManager.selectedImages,ref_key:"imageList",ref:l,width:a.value-25,onRecommend:G},null,8,["group-manager","image-size","height","properties","selected-images","width"])):y("",!0),m(o).state.display=="grid"?(s(),r("div",{key:1,style:Y({width:a.value-12+"px"}),class:"p-0 m-0 grid-container"},[C(rt,{manager:m(o).collection.groupManager,height:n.value-15,width:a.value-40,"selected-properties":k.value,class:"p-0 m-0","show-images":!0,"selected-images":m(o).collection.groupManager.selectedImages,ref_key:"imageList",ref:l,"hide-if-modal":!0},null,8,["manager","height","width","selected-properties","selected-images"])],4)):y("",!0),m(o).state.display=="graph"?(s(),V(za,{key:2,collection:m(o).collection,height:n.value-15},null,8,["collection","height"])):y("",!0)])):y("",!0)],64))}});const Da=j(Pa,[["__scopeId","data-v-2bf1a91a"]]),Ga={class:"d-flex d-row",style:{cursor:"pointer"}},La={class:"pt-1"},Ra={key:0,class:"bb bi bi-chevron-down"},Aa={key:1,class:"bb bi bi-chevron-right"},ja=["onMouseenter","onMouseleave"],Ua=["onClick"],Ha=["onClick"],Ba=["onClick"],Na=["onUpdate:modelValue"],Wa={style:{"padding-top":"2px","margin-right":"2px"}},qa={class:"lang"},Ka=["value"],Qa=L({__name:"TabNav",props:{reRender:{type:Function},filterOpen:{type:Boolean}},emits:["update:filterOpen"],setup(S,{emit:f}){const t=de(),o=ae(),d=I(-1),u=I(""),i=I(null),g=S,p=f;function l(v){o.data.selectedTabId==v||a(),o.selectTab(v)}function n(v){d.value=v,u.value=o.data.tabs[v].name,Z(()=>i.value[0].focus())}function a(){d.value=-1,u.value=""}function c(v){o.addTab("New Tab")}async function k(v){confirm("Are you sure to delete Tab: "+v.name)&&await o.removeTab(v.id)}const $=ie({});I(-1);const G=["fr","en"];function P(){p("update:filterOpen",!g.filterOpen)}return(v,_)=>(s(),r("nav",null,[e("div",Ga,[e("div",La,[e("span",{onClick:P},[g.filterOpen?(s(),r("i",Ra)):(s(),r("i",Aa))])]),(s(!0),r(E,null,q(m(o).data.tabs,w=>(s(),r("div",{class:"d-flex d-row me-2",onMouseenter:b=>$[w.id]=!0,onMouseleave:b=>$[w.id]=!1},[d.value!=w.id?(s(),r(E,{key:0},[C(F,{message:"main.menu.rename_tab_tooltip"},{default:h(()=>[e("i",{onClick:b=>n(w.id),class:B(["bi bi-pencil me-1 tab-icon hover-light",$[w.id]&&m(o).data.selectedTabId==w.id?"":"hidden"]),style:{"font-size":"10px"}},null,10,Ua)]),_:2},1024),e("div",{class:B(["tab-button",w.id==m(o).data.selectedTabId?" active":""]),onClick:b=>l(w.id)},[e("span",null,x(w.name),1)],10,Ha),C(F,{message:"main.menu.delete_tab_tooltip"},{default:h(()=>[e("i",{onClick:b=>k(w),class:B(["btn-icon bi bi-x tab-icon hover-light",$[w.id]?"":"hidden"]),style:{"font-size":"15px"}},null,10,Ba)]),_:2},1024)],64)):(s(),r("div",{key:1,class:B(["tab-button",w.id==m(o).data.selectedTabId?" active":""])},[e("form",{onSubmit:Ce(a,["stop","prevent"])},[re(e("input",{onFocusout:a,onKeydown:ut(a,["escape"]),type:"text",class:"text-input","onUpdate:modelValue":b=>w.name=b,ref_for:!0,ref_key:"inputElem",ref:i},null,40,Na),[[me,w.name]])],32)],2))],40,ja))),256)),C(F,{message:"main.menu.add_tab_tooltip"},{default:h(()=>[e("button",{class:"tab-icon hover-light ps-1 pe-1",onClick:c,id:"add-tab-button"},_[3]||(_[3]=[e("span",{class:"bi bi-plus"},null,-1)]))]),_:1}),_[6]||(_[6]=e("div",{class:"flex-grow-1"},null,-1)),e("div",Wa,[C(F,{message:"modals.notif.icon"},{default:h(()=>[e("span",{class:"bb",onClick:_[0]||(_[0]=w=>m(t).showModal(m(te).NOTIF))},_[4]||(_[4]=[e("i",{class:"bi bi-bell"},null,-1)]))]),_:1})]),e("div",qa,[_[5]||(_[5]=e("i",{class:"bi bi-translate",style:{"margin-right":"0.5rem"}},null,-1)),re(e("select",{"onUpdate:modelValue":_[1]||(_[1]=w=>v.$i18n.locale=w),onChange:_[2]||(_[2]=w=>g.reRender())},[(s(),r(E,null,q(G,(w,b)=>e("option",{key:`Lang${b}`,value:w},x(w.toUpperCase()),9,Ka)),64))],544),[[dt,v.$i18n.locale]])])])]))}});const Ya={key:0},Xa={class:"d-flex flex-row m-0 p-0 overflow-hidden"},Za={class:"w-100"},Ja={key:0,class:"custom-hr"},el={key:1,class:"loading"},tl={class:"text-center"},sl={key:2,class:"loading"},ol=L({__name:"PanopticView",setup(S){const f=ae(),t=X(),o=de(),d=I(null),u=I(null),i=I(window.innerHeight),g=I(!1),p=I(!0),l=I(!0),n=T(()=>{var _;return i.value-(((_=u.value)==null?void 0:_.clientHeight)??0)}),a=T(()=>{var _;return(_=d.value)==null?void 0:_.filteredImages.map(w=>w.id)});let c=navigator.userAgent.indexOf("Mac OS X")!==-1;async function k(){p.value=!1,await Z(),p.value=!0}ne(async()=>{o.isProjectLoaded||$e.push("/"),Z(()=>{window.addEventListener("resize",$),$()}),window.addEventListener("keydown",_=>{_.key=="Control"&&(A.ctrl=!0),_.key=="Alt"&&(c&&(A.ctrl=!0),A.alt=!0),_.key=="Shift"&&(A.shift=!0),_.key=="ArrowLeft"&&(A.left=!0),_.key=="ArrowRight"&&(A.right=!0,console.log("keeeyy")),_.key=="Z"&&A.ctrl&&t.redo(),_.key=="z"&&A.ctrl&&t.undo()}),window.addEventListener("keyup",_=>{_.key=="Control"&&(A.ctrl=!1),_.key=="Alt"&&(c&&(A.ctrl=!1),A.alt=!1),_.key=="Shift"&&(A.shift=!1),_.key=="ArrowLeft"&&(A.left=!1),_.key=="ArrowRight"&&(A.right=!1)}),window.addEventListener("mousemove",_=>{A.ctrl=_.ctrlKey,A.alt=_.altKey,A.shift=_.shiftKey,c&&(A.ctrl=A.ctrl||A.alt)})}),Ie(()=>{window.removeEventListener("resize",$)});function $(){i.value=window.innerHeight,g.value=!0}function G(){o.showModal(te.EXPORT,a)}function P(){$e.push("/")}function v(){d.value&&d.value.updateScrollerWidth()}return(_,w)=>p.value?(s(),r("div",Ya,[d.value&&!d.value.imageList?(s(),V(pt,{key:0,tutorial:"project"})):y("",!0),(s(),r("div",{id:"panoptic",key:m(f).status.renderNb},[e("div",Xa,[m(f).status.loaded?(s(),r(E,{key:0},[e("div",null,[C(us,{onExport:w[0]||(w[0]=b=>G()),onToggle:v})]),e("div",Za,[e("div",{class:"ms-1",ref_key:"navElem",ref:u},[C(Qa,{"re-render":k,filterOpen:l.value,"onUpdate:filterOpen":w[1]||(w[1]=b=>l.value=b)},null,8,["filterOpen"])],512),g.value?(s(),r("div",Ja)):y("",!0),C(Da,{"tab-id":m(f).data.selectedTabId,height:n.value,ref_key:"mainViewRef",ref:d,"filter-open":l.value},null,8,["tab-id","height","filter-open"])])],64)):m(o).isProjectLoaded?(s(),r("div",sl,w[2]||(w[2]=[e("i",{class:"spinner-border",role:"status"},null,-1),e("span",{class:"ms-1"},"Loading...",-1)]))):(s(),r("div",el,[e("div",tl,[e("div",null,x(_.$t("main.status.no_project")),1),e("div",{class:"bi bi-house p-3",onClick:P,style:{"font-size":"50px",cursor:"pointer"}})])]))])]))])):y("",!0)}});const nl=j(ol,[["__scopeId","data-v-082194ff"]]);export{nl as default};
