import{d as O,Q as Be,u as ue,S as fe,z as K,r as M,c as T,V as q,o as t,a as l,b as e,F as E,q as _,W as ce,t as x,h as g,k as C,w as de,v as _e,e as u,X as Ge,M as oe,l as b,Y as F,Z as $e,$ as ve,n as H,O as W,a0 as Ce,i as ee,s as j,D as te,a1 as je,_ as U,a2 as Ne,a3 as Ie,a4 as Te,f as X,a5 as he,a6 as Me,m as J,G as He,a7 as pe,a8 as Ee,j as Z,g as we,a9 as We,aa as qe,ab as ze,ac as Ke,ad as Qe,J as Ye,ae as Xe,af as Ze,K as Je,R as et,L as tt,ag as st,ah as ot,ai as Pe,aj as Oe,ak as at,al as le,am as se,an as lt,ao as nt,ap as it,aq as rt,ar as ut,as as dt,at as me,au as Ve,av as pt,aw as ct,ax as mt,ay as vt,az as gt,aA as ft,aB as _t,x as yt,p as Fe,A as B}from"./index-ae4b7bc8.js";import{_ as bt}from"./Tutorial-6d5665e8.js";const ge={},ht={class:"d-flex flex-row"},kt={key:2,class:"d-flex",style:{width:"150px"}},xt={class:"flex-grow-1"},$t={key:1,style:{"padding-top":"1px"}},wt={style:{width:"20px","margin-top":"2px"},class:"text-center"},St={key:4,class:"text-center",style:{width:"20px","margin-top":"2px"}},Ct={key:0},It={key:0,class:"ms-3 pt-1"},Vt={class:"options hover-light"},Mt={class:"p-1",style:{"min-width":"100px"}},zt={key:1,class:"custom-hr mt-1 mb-1"},Ft=["onClick"],Gt={key:1},Tt=O({__name:"PropertyOptions",props:{tab:{},property:{},open:{type:Boolean}},setup(h){const{t:d}=Be({useScope:"global"}),s=ue();fe();const a=K(),o=h,m=M(!1),p=M(!1),y=M(""),v=M(!1),r=T(()=>o.tab.state.visibleProperties[o.property.id]==!0),n=T(()=>o.tab.collection.filterManager.state.filter.filters.some(w=>!w.isGroup&&w.propertyId==o.property.id)),i=T(()=>o.tab.collection.groupManager.state.groupBy.includes(o.property.id)),c=T(()=>o.tab.collection.sortManager.state.sortBy.includes(o.property.id)),f=T(()=>{if(n.value)return o.tab.collection.filterManager.state.filter.filters.find(w=>!w.isGroup&&w.propertyId==o.property.id).id}),S=()=>o.tab.collection.filterManager,D=T(()=>o.tab.getSha1Mode());function A(){r.value?o.tab.setVisibleProperty(o.property.id,!1):o.tab.setVisibleProperty(o.property.id,!0)}function I(){o.open&&(m.value?m.value=!1:(m.value=!0,y.value=o.property.name),p.value=!1)}function k(){o.property.type!=W.tag&&o.property.type!=W.multi_tags||(p.value?p.value=!1:p.value=!0,m.value=!1)}function G(){c.value?o.tab.collection.sortManager.delSort(o.property.id):o.tab.collection.sortManager.setSort(o.property.id),o.tab.collection.sortManager.update(!0)}function L(){i.value?o.tab.collection.groupManager.delGroupOption(o.property.id):o.tab.collection.groupManager.setGroupOption(o.property.id),o.tab.collection.groupManager.update(!0)}function P(){confirm(d("common.properties.delete")+": "+o.property.name+" ?   "+o.property.id)&&a.deleteProperty(o.property.id)}async function Q(){y.value!=""&&(await a.updateProperty(o.property.id,y.value),I())}function R(){const w=S();n.value?(w.deleteFilter(f.value),ge.filter.hide()):(w.addNewFilter(o.property.id),ge.filter.show())}function z(w){a.updateProperty(o.property.id,o.property.name,w)}return q(()=>o.property,()=>{m.value=!1}),(w,$)=>(t(),l("div",{class:H(v.value?"hover-light":"")},[e("div",ht,[o.open?(t(),l(E,{key:0},[m.value?g("",!0):(t(),l("div",{key:0,class:"option-holder hover-light btn-icon",style:{width:"150px"},onClick:I},[_(ce,{type:o.property.type,class:"me-2 btn-icon",onMouseenter:$[0]||($[0]=V=>v.value=!0),onMouseleave:$[1]||($[1]=V=>v.value=!1)},null,8,["type"]),e("span",null,x(o.property.name),1)]))],64)):(t(),C(ce,{key:1,type:o.property.type,class:"me-2",style:{position:"relative",top:"2px"}},null,8,["type"])),m.value&&o.open?(t(),l("div",kt,[e("div",null,[e("i",{class:"btn-icon me-1 bi bi-x-lg",style:{padding:"2px"},onClick:I,onMouseenter:$[2]||($[2]=V=>v.value=!0),onMouseleave:$[3]||($[3]=V=>v.value=!1)},null,32)]),e("div",xt,[o.property.id>=0?de((t(),l("input",{key:0,style:{position:"relative",top:"1px"},type:"text",class:"text-input","onUpdate:modelValue":$[4]||($[4]=V=>y.value=V),onChange:Q},null,544)),[[_e,y.value]]):(t(),l("span",$t,[_(ce,{type:o.property.type,class:"me-2 btn-icon"},null,8,["type"]),e("span",null,x(o.property.name),1)]))])])):g("",!0),o.open?(t(),l(E,{key:3},[u(Ge)(o.property.type)?(t(),l("div",{key:0,style:{width:"20px","margin-top":"2px",cursor:"pointer"},class:"text-center",onClick:$[5]||($[5]=V=>u(s).showModal(u(oe).TAG,{propId:o.property.id}))},[_(F,{click:!1,message:"main.nav.properties.open_tags"},{default:b(()=>$[8]||($[8]=[e("i",{class:"bi bi-arrows-fullscreen"},null,-1)])),_:1})])):g("",!0),e("div",wt,[o.property.mode==u($e).id?(t(),C(F,{key:0,click:!1,message:"main.nav.properties.linked_property_tooltip"},{default:b(()=>$[9]||($[9]=[e("i",{class:"bi bi-link-45deg"},null,-1)])),_:1})):g("",!0)])],64)):g("",!0),e("div",{style:{width:"20px","margin-top":"2px"},onClick:A,class:"btn-icon text-center"},[D.value&&o.property.mode==u($e).id?(t(),C(F,{key:0,message:"main.nav.properties.hidden_property_tooltip"},{default:b(()=>[e("span",{class:"bi bi-eye-slash",onClick:$[6]||($[6]=ve(()=>{},["stop"]))})]),_:1})):(t(),C(F,{key:1,pos:"right",message:"main.nav.properties.hide_property_tooltip"},{default:b(()=>[e("span",{class:H("bi bi-eye text-"+(r.value?"primary":"secondary"))},null,2)]),_:1}))]),o.open?(t(),l("div",St,[o.property.type==u(W).tag||o.property.type==u(W).multi_tags?(t(),l("div",{key:0,onClick:k,style:{cursor:"pointer"}},[p.value?(t(),C(F,{key:0,message:"main.nav.properties.collapse_property_tooltip"},{default:b(()=>$[10]||($[10]=[e("i",{class:"bi bi-chevron-down"},null,-1)])),_:1})):(t(),C(F,{key:1,message:"main.nav.properties.expand_property_tooltip"},{default:b(()=>$[11]||($[11]=[e("i",{class:"bi bi-chevron-right"},null,-1)])),_:1}))])):g("",!0)])):g("",!0)]),o.open?(t(),l("div",Ct,[m.value?(t(),l("div",It,[w.property.id!=u(Ce).folders?(t(),l("div",{key:0,class:H(["options hover-light",n.value?" text-primary":""]),onClick:R},[e("div",null,[$[12]||($[12]=e("i",{class:"bi bi-funnel-fill me-2"},null,-1)),ee(x(w.$t("main.menu.filters")),1)])],2)):g("",!0),e("div",{class:H(["options hover-light",c.value?" text-primary":""]),onClick:G},[$[13]||($[13]=e("i",{class:"bi bi-filter me-2"},null,-1)),ee(x(w.$t("main.menu.sort.title")),1)],2),e("div",{class:H(["options hover-light",i.value?" text-primary":""]),onClick:L},[$[14]||($[14]=e("i",{class:"bi bi-collection me-2"},null,-1)),ee(x(w.$t("main.menu.groupby")),1)],2),o.property.id>=0?(t(),l("div",{key:1,class:"options hover-light",onClick:P},[$[15]||($[15]=e("i",{class:"bi bi-trash me-2"},null,-1)),ee(x(w.$t("main.nav.properties.delete_property")),1)])):g("",!0),o.property.id>=0&&u(a).propertyGroupsList.length?(t(),C(te,{key:2,teleport:!0},{button:b(()=>[e("div",Vt,[$[16]||($[16]=e("i",{class:"bi bi-folder me-1"},null,-1)),ee(" "+x(w.$t("main.nav.properties.set_group")),1)])]),popup:b(()=>[e("div",Mt,[o.property.propertyGroupId&&u(a).propertyGroups[o.property.propertyGroupId]?(t(),l("div",{key:0,class:"bb",onClick:$[7]||($[7]=V=>z(null))},"None")):g("",!0),o.property.propertyGroupId&&u(a).propertyGroups[o.property.propertyGroupId]?(t(),l("div",zt)):g("",!0),(t(!0),l(E,null,j(u(a).propertyGroupsList,V=>(t(),l("div",{class:"bb",onClick:N=>z(V.id)},x(V.name),9,Ft))),256))])]),_:1})):g("",!0)])):p.value?(t(),l("div",Gt,[_(je,{property:o.property,"can-create":!0,"can-customize":!0,"can-delete":!0,"can-link":!0},null,8,["property"])])):g("",!0)])):g("",!0)],2))}});const Se=U(Tt,[["__scopeId","data-v-f4c9ce19"]]),Et={class:"text-nowrap"},Pt=["onClick"],Ot=["onClick"],Lt=O({__name:"FolderOptionDropdown",props:{folder:{}},setup(h){const d=K(),s=h;function a(){d.reImportFolder(s.folder.id)}function o(){confirm(Ne.global.t("main.nav.folders.del_alert"))&&d.deleteFolder(s.folder.id)}return(m,p)=>(t(),C(te,{teleport:!0},{button:b(()=>p[0]||(p[0]=[e("i",{class:"bi bi-three-dots base-hover"},null,-1)])),popup:b(({hide:y})=>[e("div",Et,[e("div",{class:"p-2 bb",onClick:v=>{a(),y()}},p[1]||(p[1]=[e("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),ee("Re import")]),8,Pt),p[3]||(p[3]=e("div",{class:"custom-hr"},null,-1)),e("div",{class:"bb p-2",onClick:v=>{o(),y()}},[p[2]||(p[2]=e("i",{class:"bi bi-trash me-1"},null,-1)),ee(x(m.$t("main.nav.folders.del")),1)],8,Ot)])]),_:1}))}}),Dt=["onMouseenter"],Rt={style:{display:"inline"}},At=["onClick"],Ut={class:"text-secondary"},Bt=["onClick"],jt=O({__name:"FolderList2",props:{folders:Array,visibleFolders:Object,filterManager:Ie,root:{type:Boolean,default:!0}},setup(h){const d=K(),s=h,a=M(null),o=T(()=>{let n={};const i=new Set(s.filterManager.state.folders);return s.folders.map(c=>c.id).forEach(c=>{i.has(c)&&(n[c]=!0)}),n}),m=T(()=>{let n={};return s.folders.map(i=>i.id).forEach(i=>{s.visibleFolders[i]&&(n[i]=!0)}),n}),p=T(()=>{let n={};return s.folders.forEach(i=>{let c=[];o.value[i.id]&&c.push("selected"),n[i.id]=c.join(" ")}),n});function y(n){let i=s.visibleFolders;i[n]?delete i[n]:i[n]=!0}function v(n){let i=new Set(s.filterManager.state.folders);const c=i.has(n),f=d.folders[n].parent!=null&&i.has(d.folders[n].parent);c&&!f?(i.delete(n),he(n).forEach(S=>i.delete(S.id))):(r(n,i),i.add(n),he(n).forEach(S=>i.add(S.id)),Me(d.folders[n]).forEach(S=>i.delete(S.id))),s.filterManager.setFolders(Array.from(i)),s.filterManager.update(!0)}function r(n,i){const c=Me(d.folders[n]);let f;for(let S of c)if(i.has(S.id))f=S;else break;f!=null&&he(f.id).forEach(S=>i.delete(S.id))}return(n,i)=>{const c=Te("FolderList2",!0);return t(),l("ul",{class:H(s.root?"tree":""),style:X(s.root?"padding-left:0px;":"")},[(t(!0),l(E,null,j(h.folders,f=>(t(),l("li",{style:X(s.root?"padding-left:0px;":""),class:"no-break",onMouseenter:S=>a.value=f.id,onMouseleave:i[0]||(i[0]=S=>a.value=null)},[e("div",Rt,[e("summary",{class:H(p.value[f.id]),onClick:S=>v(f.id)},[ee(x(f.name)+" ",1),e("span",Ut,x(u(d).folders[f.id].count),1)],10,At)]),f.children&&f.children.length>0?(t(),l("i",{key:0,onClick:S=>y(f.id),class:H("bi bi-chevron-"+(m.value[f.id]?"down":"right")+" ms-2 btn-icon"),style:{"font-size":"9px"}},null,10,Bt)):g("",!0),e("span",{class:H(a.value===f.id?"visible-option":"invisible-option")},[_(Lt,{folder:f,style:{display:"inline-block"}},null,8,["folder"])],2),f.children&&f.children.length>0&&m.value[f.id]?(t(),C(c,{key:1,folders:f.children,root:!1,"visible-folders":s.visibleFolders,"filter-manager":s.filterManager},null,8,["folders","visible-folders","filter-manager"])):g("",!0)],44,Dt))),256))],6)}}});const Nt=U(jt,[["__scopeId","data-v-2aa7e825"]]),Ht={class:"text-center"},Wt={class:"w-100 text-center",style:{"font-size":"10px"}},qt={key:0,class:"progress",role:"progressbar","aria-label":"Example 1px high","aria-valuemin":"0","aria-valuemax":"100",style:{height:"1px"}},Kt=O({__name:"TaskStatus",props:{task:{}},setup(h){const d=h,s=T(()=>d.task.total-d.task.remain-d.task.computing),a=T(()=>d.task.total);return(o,m)=>(t(),l("div",Ht,[ee(x(d.task.name)+" ",1),e("div",Wt,x(s.value)+" / "+x(a.value)+" "+x(o.$t("main.nav.tasks.done")),1),a.value>0?(t(),l("div",qt,[e("div",{class:"progress-bar",style:X(`width: ${s.value/a.value*100}%`)},null,4)])):g("",!0)]))}}),Qt={class:"prop-container"},Yt={key:0},Xt={key:1},Zt={key:0,class:"ms-2 text-capitalize overflow-hidden"},Jt={key:1,class:"ms-2"},es={key:0,class:"ps-1 pe-1 pt-1"},ts={class:"property-item"},ss=O({__name:"PropertyGroup",props:{tab:{},group:{},menuOpen:{type:Boolean}},setup(h){const d=K(),s=h,a=M(!0),o=M(!1),m=M(""),p=T(()=>d.propertyList.filter(i=>i.propertyGroupId==s.group.id));function y(){a.value=!a.value}function v(i){d.updatePropertyGroup(s.group.id,m.value)}function r(){m.value=s.group.name}function n(){d.deletePropertyGroup(s.group.id)}return J(r),q(s,r),(i,c)=>(t(),l("div",Qt,[e("div",{class:"d-flex group-container",onClick:y},[a.value?(t(),l("div",Yt,c[3]||(c[3]=[e("i",{class:"bi bi-caret-down-fill"},null,-1)]))):g("",!0),a.value?g("",!0):(t(),l("div",Xt,c[4]||(c[4]=[e("i",{class:"bi bi-caret-right-fill"},null,-1)]))),s.menuOpen?(t(),l(E,{key:2},[o.value?g("",!0):(t(),l("div",Zt,x(s.group.name),1)),o.value?(t(),l("div",Jt,[_(He,{"auto-focus":!0,modelValue:m.value,"onUpdate:modelValue":c[0]||(c[0]=f=>m.value=f),style:{"background-color":"white"},"min-height":25,width:135,onSubmit:v,onCancel:r,onBlur:c[1]||(c[1]=f=>o.value=!1)},null,8,["modelValue"])])):g("",!0),c[7]||(c[7]=e("div",{class:"flex-grow-1"},null,-1)),o.value?g("",!0):(t(),l("div",{key:2,class:"bb me-1",onClick:c[2]||(c[2]=ve(f=>o.value=!0,["stop"]))},c[5]||(c[5]=[e("i",{class:"bi bi-pencil"},null,-1)]))),e("div",{class:"bb me-1",onClick:ve(n,["stop"])},c[6]||(c[6]=[e("i",{class:"bi bi-x"},null,-1)]))],64)):g("",!0)]),a.value&&p.value.length?(t(),l("div",es,[(t(!0),l(E,null,j(p.value,f=>(t(),l("div",ts,[_(Se,{tab:s.tab,property:f,open:s.menuOpen},null,8,["tab","property","open"])]))),256))])):g("",!0)]))}});const os=U(ss,[["__scopeId","data-v-d485bd74"]]),Le=O({__name:"TabContainer",props:{id:{}},setup(h){const d=pe(),s=h;let a;const o=M(!1);function m(){a=d.getTab(s.id),o.value=!0}return J(m),q(()=>s.id,async()=>{o.value=!1,await Z(),m()}),(p,y)=>o.value&&u(d).loaded?Ee(p.$slots,"default",{key:0,tab:u(a)}):g("",!0)}}),as={class:""},ls={class:"m-0",style:{padding:"4px 0px 4px 8px"}},ns={class:"d-flex align-items-center",style:{"font-size":"15px","line-height":"14px"}},is={key:0,class:"bi bi-chevron-left"},rs={key:1,class:"bi bi-chevron-right"},us={class:"ps-2 pe-2",style:{"padding-bottom":"9.5px"}},ds={class:"d-flex align-items-center"},ps={style:{"max-height":"300px",overflow:"auto"}},cs={key:0,id:"import"},ms={class:"pt-1 pb-2"},vs={class:"d-flex align-items-center ps-2 pe-2",style:{height:"30px"}},gs={key:0,class:"ps-2 pe-2"},fs={class:"p-1"},_s={key:0,class:"custom-hr"},ys={class:"p-1 mt-0"},bs={key:0,class:"d-flex p-1"},hs={key:0,class:"spinner-grow spinner-grow-sm float-end",style:{width:"10px",height:"10px","margin-top":"5px"}},ks={key:1,class:"bb me-1"},xs={class:"bb me-2"},$s={key:1,class:"mt-2"},ws={style:{"padding-left":"0px"}},Ss={class:"ps-1 pe-1"},Cs={key:0,class:"property-item"},Is={class:"p-2 mt-0"},Vs={key:1,class:"mt-2"},Ms={key:0,class:"property-item"},zs=200,Fs=55,Gs=O({__name:"Menu",emits:["export","toggle"],setup(h,{emit:d}){const s=fe(),a=K(),o=ue(),m=pe(),p=d,y=M(!1),v=M(!1),r=M(!0),n=T(()=>r.value?zs:Fs),i=T(()=>a.propertyList.filter(I=>I.id>=0&&(I.propertyGroupId===void 0||!a.propertyGroups[I.propertyGroupId]))),c=async I=>{o.showModal(oe.IMPORT)},f=T(()=>s.backendStatus.tasks.filter(I=>!I.done));function S(){o.showModal(oe.FOLDERSELECTION,{callback:D,mode:"images"})}function D(I){I&&a.addFolder(I)}function A(){r.value=!r.value,p("toggle")}return q(()=>s.status.import.to_import,()=>y.value=!0),(I,k)=>(t(),C(Le,{id:u(m).mainTab},{default:b(({tab:G})=>{var L;return[e("div",{class:"menu overflow-scroll",style:X({width:n.value+"px"})},[e("div",as,[e("div",null,[e("div",ls,[e("div",ns,[r.value?(t(),l(E,{key:0},[e("div",{class:"flex-grow-1 text-capitalize overflow-hidden",onClick:k[0]||(k[0]=()=>{})},x((L=u(o).data.status.selectedProject)==null?void 0:L.name),1),_(F,{message:"main.menu.close_project"},{default:b(()=>[e("div",{class:"base-hover p-1",onClick:k[1]||(k[1]=P=>u(o).closeProject())},k[7]||(k[7]=[e("i",{class:"bi bi-arrow-up-left-square red-hover"},null,-1)]))]),_:1}),e("div",{class:"base-hover p-1",onClick:k[2]||(k[2]=P=>u(o).showModal(u(oe).SETTINGS))},k[8]||(k[8]=[e("i",{class:"bi bi-gear"},null,-1)]))],64)):g("",!0),e("div",{class:H(["base-hover p-1",r.value?"":"flex-grow-1 text-center"]),style:{"margin-right":"6px"},onClick:A},[r.value?(t(),l("i",is)):(t(),l("i",rs))],2)])]),r.value?(t(),l(E,{key:0},[k[10]||(k[10]=e("div",{class:"custom-hr"},null,-1)),e("div",us,[e("div",ds,[e("div",null,[e("b",null,x(I.$t("main.nav.folders.title")),1)]),e("div",{id:"add_folder",class:"ms-auto plus",onClick:k[3]||(k[3]=P=>{S(),u(we)()})},[_(F,{message:"main.nav.folders.add"},{default:b(()=>k[9]||(k[9]=[e("i",{class:"bi bi-plus"},null,-1)])),_:1})])]),e("div",ps,[_(Nt,{folders:u(a).folderRoots,"filter-manager":G.collection.filterManager,"visible-folders":G.state.visibleFolders},null,8,["folders","filter-manager","visible-folders"])])])],64)):g("",!0),r.value?(t(),l(E,{key:1},[f.value&&f.value.length?(t(),l("div",cs,[k[12]||(k[12]=e("div",{class:"custom-hr"},null,-1)),e("div",ms,[e("div",vs,[e("div",null,[e("b",null,x(I.$t("main.nav.tasks.title")),1)])]),k[11]||(k[11]=e("div",{class:"custom-hr"},null,-1)),u(s).backendStatus?(t(),l("div",gs,[(t(!0),l(E,null,j(f.value,(P,Q)=>(t(),l("div",fs,[Q?(t(),l("div",_s)):g("",!0),_(Kt,{task:P},null,8,["task"])]))),256))])):g("",!0)])])):g("",!0)],64)):g("",!0),k[19]||(k[19]=e("div",{class:"custom-hr"},null,-1)),e("div",ys,[r.value?(t(),l("div",bs,[_(F,{message:"main.nav.properties.properties_tooltip",pos:"top",icon:!0},{default:b(()=>[e("b",null,x(I.$t("main.nav.properties.title")),1)]),_:1}),k[14]||(k[14]=e("span",{class:"flex-grow-1"},null,-1)),v.value?(t(),l("span",hs,k[13]||(k[13]=[e("span",{class:"sr-only"},null,-1)]))):(t(),l("span",ks,[_(F,{pos:"right",message:"main.nav.properties.import_properties_tooltip"},{default:b(()=>[e("i",{class:"bi bi-box-arrow-in-up text-secondary",style:{position:"relative",top:"0px","font-size":"15px"},onClick:c})]),_:1})])),e("span",xs,[_(F,{pos:"right",message:"main.nav.properties.export_properties_tooltip"},{default:b(()=>[e("i",{class:"bi bi-box-arrow-up text-secondary",style:{position:"relative",top:"0px","font-size":"15px"},onClick:k[4]||(k[4]=P=>u(o).showModal(u(oe).EXPORT,void 0))})]),_:1})])])):g("",!0),u(s).status.loaded?(t(),l("div",$s,[(t(!0),l(E,null,j(u(We)(u(a).propertyGroups),P=>(t(),l("div",ws,[_(os,{tab:G,group:P,class:"mb-1","menu-open":r.value},null,8,["tab","group","menu-open"])]))),256)),(t(!0),l(E,null,j(i.value,P=>(t(),l("div",Ss,[P.id>=0?(t(),l("div",Cs,[_(Se,{tab:G,property:P,open:r.value},null,8,["tab","property","open"])])):g("",!0)]))),256)),r.value?(t(),l(E,{key:0},[k[17]||(k[17]=e("div",{class:"property-item m-0 p-0"},null,-1)),e("div",{id:"add-property",onClick:k[5]||(k[5]=P=>{u(o).showModal(u(oe).PROPERTY,void 0),u(we)()}),class:"btn-icon base-hover mt-1",style:{"line-height":"25px"}},[k[15]||(k[15]=e("i",{class:"bi bi-plus btn-icon float-start",style:{"font-size":"25px"}},null,-1)),e("span",null,x(I.$t("main.nav.properties.add_property")),1)]),k[18]||(k[18]=e("div",{class:"custom-hr mt-1"},null,-1)),e("div",{onClick:k[6]||(k[6]=P=>u(a).addPropertyGroup("New Group")),class:"btn-icon base-hover mt-1",style:{"line-height":"25px"}},[k[16]||(k[16]=e("i",{class:"bi bi-plus btn-icon float-start",style:{"font-size":"25px"}},null,-1)),e("span",null,x(I.$t("main.nav.properties.add_property_group")),1)])],64)):g("",!0)])):g("",!0)]),k[20]||(k[20]=e("div",{class:"custom-hr"},null,-1)),e("div",Is,[r.value?(t(),C(F,{key:0,message:"main.nav.computed.computed_tooltip",icon:!0},{default:b(()=>[e("b",null,x(I.$t("main.nav.computed.title")),1)]),_:1})):g("",!0),u(s).status.loaded?(t(),l("div",Vs,[(t(!0),l(E,null,j(u(a).properties,P=>(t(),l(E,null,[P.id<0&&P.id!=u(qe)?(t(),l("div",Ms,[_(F,{pos:"bottom",message:"main.nav.computed."+Math.abs(P.id).toString()+"_tooltip"},{default:b(()=>[_(Se,{tab:G,property:P,open:r.value},null,8,["tab","property","open"])]),_:2},1032,["message"])])):g("",!0)],64))),256))])):g("",!0)])])])],4)]}),_:1},8,["id"]))}});const Ts=U(Gs,[["__scopeId","data-v-65c5f050"]]),Es={class:"p-0 hover-light ps-1 bb",style:{width:"50px"}},Ps={class:""},Os=["onClick"],Ls=O({__name:"FilterGroupOperator",props:{modelValue:{}},emits:["update:modelValue"],setup(h,{emit:d}){const s=h,a=d;function o(m){a("update:modelValue",m)}return(m,p)=>(t(),C(te,null,{button:b(()=>[e("div",Es,[e("span",Ps,x(m.$t("modals.filters."+s.modelValue)),1)])]),popup:b(({hide:y})=>[e("div",{class:"ps-2 pt-1 pb-1 pe-2",onClick:y},[e("div",{class:"base-btn",onClick:p[0]||(p[0]=v=>o(u(ze).and))},x(m.$t("modals.filters.and")),1),p[2]||(p[2]=e("hr",{class:"m-0 p-0 mt-1 mb-1"},null,-1)),e("div",{class:"base-btn",onClick:p[1]||(p[1]=v=>o(u(ze).or))},x(m.$t("modals.filters.or")),1)],8,Os)]),_:1}))}}),Ds=["disabled"],Rs={class:"m-0 p-1"},As=["onClick"],Us=O({__name:"OperatorChoice",props:{propertyId:{},modelValue:{},disabled:{type:Boolean}},emits:["hide","update:modelValue"],setup(h,{emit:d}){const s=K(),a=h,o=d,m=T(()=>s.properties[a.propertyId]),p=T(()=>Ke(m.value.type));async function y(v){o("update:modelValue",v)}return(v,r)=>(t(),C(te,{onHide:r[0]||(r[0]=n=>o("hide")),placement:"bottom"},{button:b(()=>[e("div",{class:"text-nowrap sb ps-1 pe-1",disabled:a.disabled},[e("span",null,x(v.$t("modals.filters.operators."+a.modelValue)),1)],8,Ds)]),popup:b(({hide:n})=>[e("div",Rs,[(t(!0),l(E,null,j(p.value,i=>(t(),l("div",{class:"hover-light p-1 rounded",style:{cursor:"pointer"},onClick:c=>{y(i),n()}},[e("a",null,x(v.$t("modals.filters.operators."+i)),1)],8,As))),256))])]),_:1}))}});const Bs=U(Us,[["__scopeId","data-v-21b8bb8e"]]),js={class:"d-flex text-nowrap overflow-hidden",style:{"font-size":"14px"}},Ns=O({__name:"FilterValueInput",props:{modelValue:{},property:{},width:{}},emits:["update:modelValue"],setup(h,{emit:d}){const s=h,a=d;function o(m){a("update:modelValue",m)}return(m,p)=>(t(),l("div",js,[u(Ge)(m.property.type)?(t(),C(Qe,{key:0,"model-value":s.modelValue,"onUpdate:modelValue":o,"no-wrap":!0,"auto-focus":!0,"can-create":!1,"can-customize":!1,property:s.property,teleport:!1,width:s.width,class:"sb","force-multi":!0},null,8,["model-value","property","width"])):s.property.type==u(W).color?(t(),C(Ye,{key:1,"model-value":s.modelValue,"onUpdate:modelValue":o,width:s.width,rounded:!0,"min-height":22,teleport:!1,offset:2,class:"sb"},null,8,["model-value","width"])):s.property.type==u(W).number?(t(),C(Xe,{key:2,"model-value":s.modelValue,"onUpdate:modelValue":o,width:s.width,height:26,"input-offset":0,class:"sb"},null,8,["model-value","width"])):s.property.type==u(W).url?(t(),C(Ze,{key:3,"model-value":s.modelValue,"onUpdate:modelValue":o,width:s.width,offset:-22,class:"sb"},null,8,["model-value","width"])):s.property.type==u(W).checkbox?(t(),C(Je,{key:4,"model-value":s.modelValue,"onUpdate:modelValue":o,label:s.property.name,width:s.width,class:"sb"},null,8,["model-value","label","width"])):s.property.type==u(W).date?(t(),C(et,{key:5,"model-value":s.modelValue,teleport:!1,"onUpdate:modelValue":o,width:s.width,class:"sb"},null,8,["model-value","width"])):(t(),C(tt,{key:6,"model-value":s.modelValue,"onUpdate:modelValue":o,width:s.width,offset:-22,class:"sb"},null,8,["model-value","width"]))]))}}),Hs={class:"p-0 m-0 ps-2"},Ws=O({__name:"FilterRow",props:{manager:{},filter:{}},emits:[],setup(h,{emit:d}){const s=K(),a=h,o=T(()=>s.properties[a.filter.propertyId]),m=T(()=>ot(a.filter.operator));function p(r){a.manager.updateFilter(a.filter.id,{operator:r})}function y(r){a.manager.updateFilter(a.filter.id,{value:r})}function v(r){a.manager.updateFilter(a.filter.id,{propertyId:r.id})}return(r,n)=>(t(),l(E,null,[e("td",Hs,[_(st,{"model-value":o.value,"onUpdate:modelValue":v},null,8,["model-value"])]),e("td",null,[_(Bs,{"property-id":o.value.id,"model-value":a.filter.operator,"onUpdate:modelValue":p},null,8,["property-id","model-value"])]),e("td",null,[m.value?(t(),C(Ns,{key:0,"model-value":a.filter.value,"onUpdate:modelValue":y,property:o.value,width:140,style:{width:"150px"},class:""},null,8,["model-value","property"])):g("",!0)])],64))}}),qs={style:{"max-height":"500px",overflow:"auto"}},De=O({__name:"AddFilterBtn",props:{group:{},manager:{}},emits:[],setup(h,{emit:d}){const s=h;function a(o){s.manager.addNewFilter(o,s.group.id),ge.filter.show()}return(o,m)=>(t(),C(te,{placement:"auto"},{button:b(()=>[Ee(o.$slots,"default")]),popup:b(({hide:p})=>[e("div",qs,[_(Pe,{onSelect:y=>{a(y),p()},"ignore-ids":[u(Ce).folders]},null,8,["onSelect","ignore-ids"])])]),_:3}))}}),Ks={class:"filter-group"},Qs={class:"table table-sm"},Ys={style:{height:"33px"}},Xs={class:""},Zs={key:0,class:"m-0 p-0"},Js={key:2,class:"text-secondary"},eo={class:"border rounded"},to={class:""},so=["onClick"],oo={class:"d-flex text-secondary ms-2"},ao={class:"add-options hover-light"},lo=O({__name:"FilterGroup",props:{filter:{},manager:{},parent:{}},emits:["delete"],setup(h,{emit:d}){K();const s=h,a=T(()=>s.filter),o=T(()=>a.value.filters),m=T(()=>{let r=255-(a.value.depth+1)*5;return`background: rgb(${r},${r},${r});`});function p(r){s.manager.deleteFilter(r.id)}function y(r){s.manager.addNewFilterGroup(r)}function v(r,n){s.manager.updateFilterGroup(r,n)}return(r,n)=>(t(),l("div",Ks,[e("table",Qs,[(t(!0),l(E,null,j(o.value,(i,c)=>(t(),l("tr",Ys,[e("td",Xs,[c==0?(t(),l("div",Zs,x(r.$t("modals.filters.where")),1)):c==1?(t(),C(Ls,{key:1,"model-value":a.value.groupOperator,"onUpdate:modelValue":n[0]||(n[0]=f=>v(a.value.id,f))},null,8,["model-value"])):(t(),l("span",Js,x(r.$t("modals.filters."+a.value.groupOperator)),1))]),i.propertyId!==void 0?(t(),C(Ws,{key:0,filter:i,manager:s.manager},null,8,["filter","manager"])):(t(),l("td",{key:1,colspan:"3",style:X(m.value)},[e("div",eo,[_(Re,{filter:i,manager:s.manager},null,8,["filter","manager"])])],4)),e("td",to,[e("span",{class:"base-btn",onClick:f=>p(i)},n[2]||(n[2]=[e("i",{class:"bi bi-trash"},null,-1)]),8,so)])]))),256))]),e("div",oo,[_(De,{group:s.filter,manager:s.manager},{default:b(()=>[e("div",ao,[n[3]||(n[3]=e("i",{class:"bi bi-plus"},null,-1)),ee(x(r.$t("modals.filters.new_filter")),1)])]),_:1},8,["group","manager"]),e("div",{class:"add-options hover-light",onClick:n[1]||(n[1]=i=>y(a.value.id))},[n[4]||(n[4]=e("i",{class:"bi bi-plus"},null,-1)),ee(x(r.$t("modals.filters.new_group")),1)])])]))}});const Re=U(lo,[["__scopeId","data-v-e644f737"]]),no={key:0,class:"d-flex flex-row m-0 ms-1 p-1 bg hover-light bg-medium",style:{cursor:"pointer"}},io={key:0},ro={key:0,class:"or-separator"},uo={key:0,class:"or-separator"},po={key:0,class:"m-1 p-1"},co=O({__name:"MainFilterDropdown",props:{manager:Ie},emits:["update:modelValue"],setup(h,{emit:d}){const s=K(),a=h,o=M(null),m=M(null),p=T(()=>{let v=y(a.manager.state.filter),r={};return v.forEach(n=>r[n.propertyId]=n),Object.values(r)});function y(v){let r=[];for(let n of v.filters)n.isGroup?r.push(...y(n)):r.push(n);return r}return q(()=>a.manager.state.filter.filters,()=>{a.manager.state.filter.filters.length==0&&m.value.hide()}),J(async()=>{await Z(),ge.filter=m.value}),(v,r)=>(t(),C(te,{ref_key:"dropdownElem",ref:m,placement:"top-start"},{button:b(()=>[e("div",null,[p.value.length||a.manager.state.query?(t(),l("div",no,[a.manager.state.query?(t(),l("div",io,[r[0]||(r[0]=e("span",{class:"text-primary"},"Text Query",-1)),p.value.length?(t(),l("span",ro,"|")):g("",!0)])):g("",!0),(t(!0),l(E,null,j(p.value,(n,i)=>(t(),l("div",null,[i>0?(t(),l("span",uo,"|")):g("",!0),n.propertyId==u(Ce).id?(t(),C(ce,{key:1,type:u(s).properties[n.propertyId].type,style:{"margin-right":"2px"}},null,8,["type"])):g("",!0),e("span",null,x(u(s).properties[n.propertyId].name),1)]))),256))])):g("",!0)])]),popup:b(()=>[e("div",{class:"m-0 p-0",ref_key:"popupElem",ref:o},[Object.keys(u(s).properties).length>0?(t(),l("div",po,[_(Re,{filter:a.manager.state.filter,manager:a.manager,parent:o.value},null,8,["filter","manager","parent"])])):g("",!0)],512)]),_:1},512))}});const mo=U(co,[["__scopeId","data-v-56cd3bdb"]]),vo={class:"d-flex flex-row filter-form"},go={class:"pt-1 pb-1"},fo=O({__name:"FilterForm",props:{manager:Ie},setup(h){const d=h;return(s,a)=>(t(),l("div",vo,[e("div",go,x(s.$t("main.menu.filters"))+": ",1),_(mo,{manager:d.manager},null,8,["manager"]),_(De,{manager:d.manager,group:d.manager.state.filter,class:"p-1"},{default:b(()=>a[0]||(a[0]=[e("span",{class:"base-hover plus-btn text-secondary"},[e("i",{class:"bi bi-plus"})],-1)])),_:1},8,["manager","group"])]))}});const _o=U(fo,[["__scopeId","data-v-cc2f25ec"]]),yo={class:"p-1",style:{"max-height":"400px","overflow-y":"scroll"}},bo=O({__name:"PropertyDropdown",props:{groupIds:Array},emits:["select"],setup(h,{emit:d}){const s=h,a=d,o=M(null);return(m,p)=>(t(),C(te,{ref_key:"dropdownElem",ref:o,"auto-focus":!1},{button:b(()=>p[2]||(p[2]=[e("div",{class:"text-secondary p-1"},[e("span",{class:"base-hover plus-btn"},[e("i",{class:"bi bi-plus"})])],-1)])),popup:b(()=>[e("div",yo,[_(Pe,{onClick:p[0]||(p[0]=y=>u(we)()),onSelect:p[1]||(p[1]=y=>{a("select",y),o.value.hide()}),"ignore-ids":s.groupIds},null,8,["ignore-ids"])])]),_:1},512))}});const Ae=U(bo,[["__scopeId","data-v-012e1f38"]]),ho={class:"base-hover ps-1 pe-1"},ko={class:"main"},xo=["onClick"],$o=O({__name:"TimeUnitDropdown",props:{modelValue:{}},emits:["update:modelValue"],setup(h,{emit:d}){const s=h,a=d,o=Object.values(Oe);function m(p){a("update:modelValue",p)}return(p,y)=>(t(),C(te,null,{button:b(()=>[e("div",ho,x(s.modelValue),1)]),popup:b(({hide:v})=>[e("div",ko,[(t(!0),l(E,null,j(u(o),r=>(t(),l("div",{class:"base-hover option",onClick:n=>{m(r),v()}},x(r),9,xo))),256))])]),_:1}))}});const wo=U($o,[["__scopeId","data-v-ce3e3774"]]),So={class:""},Co={class:"d-flex ipt"},Io={class:"ms-2",min:"1"},Vo=O({__name:"GroupOptionDropdown",props:{option:{}},emits:["change"],setup(h,{emit:d}){const s=h,a=d,o=M(1),m=M(Oe.Year);function p(){s.option.stepSize==o.value&&s.option.stepUnit==m.value||a("change",{stepSize:o.value,stepUnit:m.value})}function y(){o.value=s.option.stepSize??1,m.value=s.option.stepUnit}return q(()=>s.option,y),J(y),q(o,()=>{(o.value<1||o.value==null||isNaN(o.value))&&(o.value=1)}),(v,r)=>(t(),C(te,{onHide:p},{button:b(()=>r[2]||(r[2]=[e("i",{class:"bi bi-three-dots-vertical"},null,-1)])),popup:b(({hide:n,focus:i})=>[e("div",So,[e("div",Co,[e("div",null,[de(e("input",{type:"number","onUpdate:modelValue":r[0]||(r[0]=c=>o.value=c)},null,512),[[_e,o.value]])]),e("div",Io,[_(wo,{modelValue:m.value,"onUpdate:modelValue":r[1]||(r[1]=c=>m.value=c),onHide:i},null,8,["modelValue","onHide"])])])])]),_:1}))}});const Mo=U(Vo,[["__scopeId","data-v-78b647dc"]]),zo={class:"d-flex flex-row group-form"},Fo={class:"pt-1 pb-1"},Go={key:0,class:"bg-medium bg d-flex flex-row m-0 ms-1 p-0 align-items-center"},To={key:0,class:"bi bi-chevron-right smaller"},Eo=["onClick"],Po=["onClick"],Oo=["onClick"],Lo=["onClick"],Do=["onClick"],Ro=["onClick"],Ao=["onClick"],Uo=["onClick"],Bo=["onClick"],jo={key:5,class:"sm-btn"},No={key:0,class:"spinner-grow spinner-grow-sm loading ms-1"},Ho=O({__name:"GroupForm",props:{isLoading:Boolean,manager:at},setup(h){const d=K(),s=h;function a(n){s.manager.setGroupOption(n),s.manager.update(!0)}function o(n){s.manager.delGroupOption(n),s.manager.update(!0)}function m(n,i){s.manager.setGroupOption(n,{direction:i}),s.manager.sortGroups(!0)}function p(n,i){s.manager.setGroupOption(n,{type:i}),s.manager.sortGroups(!0)}function y(n,i){s.manager.setGroupOption(n,i),s.manager.update(!0)}const v=T(()=>s.manager.state.groupBy.map(n=>d.properties[n])),r=T(()=>{const n=[];return s.manager.state.groupBy.forEach(i=>{n.push({option:s.manager.state.options[i],property:d.properties[i]})}),n});return(n,i)=>(t(),l("div",zo,[e("div",Fo,x(n.$t("main.menu.groupby"))+": ",1),v.value.length?(t(),l("div",Go,[(t(!0),l(E,null,j(r.value,(c,f)=>(t(),l(E,null,[f>0?(t(),l("i",To)):g("",!0),e("div",{class:"base-hover m-1 ps-1 pe-1",onClick:S=>o(c.property.id),id:"remove-group-button"},x(c.property.name),9,Eo),c.option.type==u(le).Size?(t(),C(F,{key:1,message:"main.menu.sort.group_order_nb_tooltip"},{default:b(()=>[c.option.direction==u(se).Ascending?(t(),l("i",{key:0,class:"bi bi-sort-up-alt sm-btn",onClick:S=>p(c.property.id,u(le).Property)},null,8,Po)):(t(),l("i",{key:1,class:"bi bi-sort-down sm-btn",onClick:S=>p(c.property.id,u(le).Property)},null,8,Oo))]),_:2},1024)):(t(),C(F,{key:2,message:"main.menu.sort.group_order_az_tooltip"},{default:b(()=>[c.property.type==u(W).number?(t(),l(E,{key:0},[c.option.direction==u(se).Ascending?(t(),l("i",{key:0,class:"bi bi-sort-numeric-up sm-btn",onClick:S=>p(c.property.id,u(le).Size)},null,8,Lo)):(t(),l("i",{key:1,class:"bi bi-sort-numeric-down-alt sm-btn",onClick:S=>p(c.property.id,u(le).Size)},null,8,Do))],64)):(t(),l(E,{key:1},[c.option.direction==u(se).Ascending?(t(),l("i",{key:0,class:"bi bi-sort-alpha-up sm-btn",onClick:S=>p(c.property.id,u(le).Size)},null,8,Ro)):(t(),l("i",{key:1,class:"bi bi-sort-alpha-down-alt sm-btn",onClick:S=>p(c.property.id,u(le).Size)},null,8,Ao))],64))]),_:2},1024)),c.option.direction==u(se).Ascending?(t(),C(F,{key:3,message:"main.menu.sort.order_asc"},{default:b(()=>[e("i",{class:"bi bi-arrow-up sm-btn",onClick:S=>m(c.property.id,u(se).Descending)},null,8,Uo)]),_:2},1024)):(t(),C(F,{key:4,message:"main.menu.sort.order_desc"},{default:b(()=>[e("i",{class:"bi bi-arrow-down sm-btn",onClick:S=>m(c.property.id,u(se).Ascending)},null,8,Bo)]),_:2},1024)),c.property.type==u(W).date?(t(),l("div",jo,[_(Mo,{option:c.option,onChange:S=>y(c.property.id,S)},null,8,["option","onChange"])])):g("",!0)],64))),256)),s.isLoading?(t(),l("i",No)):g("",!0)])):g("",!0),_(Ae,{id:"add-group-button","group-ids":s.manager.state.groupBy,onSelect:i[0]||(i[0]=c=>a(c))},null,8,["group-ids"])]))}});const Wo=U(Ho,[["__scopeId","data-v-dcec9b5d"]]),qo={class:"d-flex flex-row sort-form"},Ko={class:"pt-1 pb-1"},Qo={key:0,class:"d-flex flex-row m-0 p-0 bg-medium bg ms-1 align-items-center"},Yo={key:0,class:"bi bi-chevron-right smaller"},Xo=["onClick"],Zo=["onClick"],Jo=["onClick"],ea=O({__name:"SortForm",props:{manager:lt},setup(h){const d=K(),s=h,a=T(()=>s.manager.state.sortBy.map(v=>({propertyId:v,direction:s.manager.state.options[v].direction}))),o=T(()=>a.value.map(v=>v.propertyId));function m(v){s.manager.setSort(v),s.manager.update(!0)}function p(v){s.manager.delSort(v),s.manager.update(!0)}function y(v,r){s.manager.setSort(v,{direction:r}),s.manager.update(!0)}return(v,r)=>(t(),l("div",qo,[e("div",Ko,x(v.$t("main.menu.sort.title"))+": ",1),a.value.length?(t(),l("div",Qo,[(t(!0),l(E,null,j(a.value,(n,i)=>(t(),l(E,null,[i>0?(t(),l("i",Yo)):g("",!0),e("div",{class:"me-0 ms-1 ps-1 mt-1 mb-1 pe-1 base-hover",onClick:c=>p(n.propertyId)},x(u(d).properties[n.propertyId].name),9,Xo),n.direction==u(se).Ascending?(t(),C(F,{key:1,message:"main.menu.sort.order_asc"},{default:b(()=>[e("i",{class:"bi bi-arrow-up sm-btn",onClick:c=>y(n.propertyId,u(se).Descending)},null,8,Zo)]),_:2},1024)):(t(),C(F,{key:2,message:"main.menu.sort.order_desc"},{default:b(()=>[e("i",{class:"bi bi-arrow-down sm-btn",onClick:c=>y(n.propertyId,u(se).Ascending)},null,8,Jo)]),_:2},1024))],64))),256))])):g("",!0),_(Ae,{"group-ids":o.value,onSelect:r[0]||(r[0]=n=>m(n))},null,8,["group-ids"])]))}});const ta=U(ea,[["__scopeId","data-v-4e00ef99"]]),sa={class:"custom-slider"},oa=["value","min","max","step"],aa=O({__name:"RangeInput",props:{min:{default:0},max:{default:1},step:{default:.1},modelValue:{}},emits:["update:modelValue"],setup(h,{emit:d}){const s=h,a=d,o=M(s.modelValue),m=M(null),p=(n,i,c)=>(n-i)/(c-i),y=n=>{m.value.style.setProperty("--ProgressPercent",`${n}%`)};nt(()=>{if(m.value){const n=p(o.value,m.value.min,m.value.max);y(n+0)}});function v(){a("update:modelValue",o.value)}let r=!1;return navigator.userAgent.indexOf("AppleWebKit")!=-1&&(r=!0),q(()=>s.modelValue,()=>o.value=s.modelValue),(n,i)=>(t(),l("div",sa,[e("input",{ref_key:"slider",ref:m,value:o.value,onInput:i[0]||(i[0]=({target:c})=>o.value=parseFloat(c.value)),type:"range",min:n.min,max:n.max,step:n.step,class:"slider",style:X(u(r)?"top:-5px":""),onChange:v},null,44,oa)]))}});const la=U(aa,[["__scopeId","data-v-5269b272"]]),na={class:"p-2"},ia={key:0,class:"border mb-1 p-1 text-center text-secondary",style:{"background-color":"#f7f7f7"}},ra={class:"border mb-1 p-1"},ua={class:"me"},da={key:0},pa={key:1},ca={class:"border mb-1 p-1",style:{"background-color":"#f7f7f7"}},ma={class:"d-flex center justify-content-center"},va={key:1,class:"bi bi-arrow-down text-secondary"},ga={key:3,class:"bi bi-arrow-up text-secondary"},fa={class:"border mb-1 p-1"},_a={class:"me"},ya={key:0},ba={key:1},ha={key:1,class:"border mb-1 p-1 text-center text-secondary",style:{"background-color":"#f7f7f7"}},ne=5,ka=O({__name:"HistoryDropdown",emits:[],setup(h,{emit:d}){const s=K(),a=M(!1),o=T(()=>a.value?{backgroundColor:"blue"}:{backgroundColor:"white"}),m=T(()=>[...s.history.undo].reverse().slice(0,ne)),p=T(()=>s.history.redo.slice(Math.max(s.history.redo.length-ne,0)));return q(()=>s.onUndo,()=>{console.log("changed"),a.value=!0,setTimeout(()=>a.value=!1,100)}),(y,v)=>m.value.length||p.value.length?(t(),C(te,{key:0},{button:b(()=>[_(F,{message:"dropdown.history.info"},{default:b(()=>[e("div",{class:"d-flex sb flash",style:X([{"font-size":"14px"},o.value])},[v[2]||(v[2]=e("i",{class:"bi bi-clock-history me-1"},null,-1)),e("div",null,x(y.$t("dropdown.history.button")),1)],4)]),_:1})]),popup:b(()=>[e("div",na,[u(s).history.redo.length>ne?(t(),l("div",ia," + "+x(u(s).history.redo.length-ne),1)):g("",!0),(t(!0),l(E,null,j(p.value,r=>(t(),l("div",ra,[e("span",ua,x(new Date(r.timestamp).toLocaleTimeString("fr-Fr",{hour:"2-digit",minute:"2-digit"})),1),v[3]||(v[3]=e("span",{class:"sep ms-1 me-1"},null,-1)),r.tags?(t(),l("span",da,x(r.tags)+" "+x(y.$t("dropdown.history.tags")),1)):g("",!0),r.values?(t(),l("span",pa,x(r.values)+" "+x(y.$t("dropdown.history.values")),1)):g("",!0)]))),256)),e("div",ca,[e("div",ma,[m.value.length?(t(),C(F,{key:0,message:"dropdown.history.undo"},{default:b(()=>[e("div",{class:"bi bi-arrow-down sb",onClick:v[0]||(v[0]=(...r)=>u(s).undo&&u(s).undo(...r))})]),_:1})):(t(),l("div",va)),v[4]||(v[4]=e("div",{style:{width:"30px"}},null,-1)),p.value.length?(t(),C(F,{key:2,message:"dropdown.history.redo"},{default:b(()=>[e("div",{class:"bi bi-arrow-up sb",onClick:v[1]||(v[1]=(...r)=>u(s).redo&&u(s).redo(...r))})]),_:1})):(t(),l("div",ga))])]),(t(!0),l(E,null,j(m.value,r=>(t(),l("div",fa,[e("span",_a,x(new Date(r.timestamp).toLocaleTimeString("fr-Fr",{hour:"2-digit",minute:"2-digit"})),1),v[5]||(v[5]=e("span",{class:"sep ms-1 me-1"},null,-1)),r.tags?(t(),l("span",ya,x(r.tags)+" "+x(y.$t("dropdown.history.tags")),1)):g("",!0),r.values?(t(),l("span",ba,x(r.values)+" "+x(y.$t("dropdown.history.values")),1)):g("",!0)]))),256)),u(s).history.undo.length>ne?(t(),l("div",ha," + "+x(u(s).history.undo.length-ne),1)):g("",!0)])]),_:1})):g("",!0)}});const xa=U(ka,[["__scopeId","data-v-85cd80d0"]]),$a=O({__name:"ToggleReload",props:{tab:{}},emits:[],setup(h,{emit:d}){const s=h,a=T(()=>s.tab.collection.state.autoReload?2:s.tab.collection.runState.isDirty?0:1);function o(){a.value==0?s.tab.collection.update():a.value==1?s.tab.collection.setAutoReload(!0):s.tab.collection.setAutoReload(!1)}return(m,p)=>(t(),l("div",{class:"bb font",onClick:o,style:{width:"26px",height:"30px",overflow:"hidde"}},[a.value==0?(t(),C(F,{key:0,message:"btn.reload.dirty",pos:"bottom"},{default:b(()=>p[0]||(p[0]=[e("span",{class:"bi bi-arrow-repeat text-warning"},null,-1)])),_:1})):g("",!0),a.value==1?(t(),C(F,{key:1,message:"btn.reload.valid",pos:"bottom"},{default:b(()=>p[1]||(p[1]=[e("span",{class:"bi bi-check2-all text-success"},null,-1)])),_:1})):g("",!0),a.value==2?(t(),C(F,{key:2,message:"btn.reload.auto",pos:"bottom"},{default:b(()=>p[2]||(p[2]=[e("div",{style:{height:"30px"}},[e("span",{class:"bi bi-check2-all text-success small-valid"}),e("span",{class:"bi bi-arrow-repeat big-arrow text-warning",style:{opacity:"0.3"}})],-1)])),_:1})):g("",!0)]))}});const wa=U($a,[["__scopeId","data-v-91d89d17"]]),Sa={class:"d-flex flex-row p-2"},Ca=["placeholder"],Ia={class:"me-5 d-flex"},Va={class:"ms-5",style:{"font-size":"13px"}},Ma=["checked"],za={class:"ms-1"},Fa={class:"ms-4"},Ga={class:"d-flex flex-wrap content-container ps-2"},Ta=O({__name:"ContentFilter",props:{tab:{},computeStatus:{}},emits:["compute-ml","search-images","remove:selected"],setup(h,{emit:d}){const s=h,a=M(""),o=T(()=>Object.keys(s.tab.collection.groupManager.selectedImages.value).map(Number)),m=T(()=>o.value.length);function p(n){const i=n.target.checked;s.tab.collection.groupManager.setSha1Mode(i,!0)}function y(){a.value=s.tab.state.filterState.query}function v(){s.tab.collection.filterManager.setQuery(a.value),s.tab.collection.filterManager.update(!0)}function r(){s.tab.collection.filterManager.setQuery(""),s.tab.collection.filterManager.update(!0)}return J(y),q(()=>s.tab.collection.filterManager.state.query,y),(n,i)=>(t(),l(E,null,[e("div",Sa,[_(F,{icon:!0,message:"main.menu.search_tooltip",iconPos:"left"},{default:b(()=>[e("div",{class:H(["d-flex flex-row search-input me-5",a.value?"border-primary":""])},[i[6]||(i[6]=e("div",{class:"bi bi-search float-start bi-sm"},null,-1)),de(e("input",{type:"text",class:"input-hidden",placeholder:n.$t("main.menu.search"),"onUpdate:modelValue":i[0]||(i[0]=c=>a.value=c),onChange:v},null,40,Ca),[[_e,a.value]]),e("div",{class:"bi-sm base-hover",style:{cursor:"pointer",padding:"0px 2px"},onClick:r},"x")],2)]),_:1}),e("div",Ia,[_(F,{message:"main.menu.grid_tooltip"},{default:b(()=>[e("i",{class:H("bi bi-grid-3x3-gap-fill me-2 btn-icon"+(s.tab.state.display=="tree"?"":" text-secondary")),onClick:i[1]||(i[1]=c=>s.tab.setViewMode("tree"))},null,2)]),_:1}),_(F,{message:"main.menu.table_tooltip"},{default:b(()=>[e("i",{id:"toot",class:H("bi bi-table btn-icon me-2"+(s.tab.state.display=="grid"?"":" text-secondary")),onClick:i[2]||(i[2]=c=>s.tab.setViewMode("grid"))},null,2)]),_:1}),_(F,{message:"main.menu.graph_tooltip"},{default:b(()=>[e("i",{id:"toot",class:H("bi bi-bar-chart btn-icon"+(s.tab.state.display=="graph"?"":" text-secondary")),onClick:i[3]||(i[3]=c=>s.tab.setViewMode("graph"))},null,2)]),_:1})]),_(F,{message:"main.menu.image_size_tooltip",click:!1},{default:b(()=>i[7]||(i[7]=[e("div",{class:"bi bi-aspect-ratio me-1"},null,-1)])),_:1}),e("div",null,[_(la,{min:30,max:500,modelValue:s.tab.state.imageSize,"onUpdate:modelValue":i[4]||(i[4]=c=>s.tab.state.imageSize=c)},null,8,["modelValue"])]),e("div",Va,[_(F,{message:"main.menu.image_mode_tooltip"},{default:b(()=>[e("input",{type:"checkbox",checked:s.tab.collection.groupManager.state.sha1Mode,onChange:p},null,40,Ma),e("span",za,x(n.$t("main.menu.image_mode")),1)]),_:1})]),e("div",Fa,[_(xa)]),m.value?(t(),C(it,{key:0,id:"selection-stamp",class:"ms-5","selected-images-ids":o.value,"onRemove:selected":i[5]||(i[5]=c=>s.tab.collection.groupManager.clearSelection())},null,8,["selected-images-ids"])):g("",!0),i[9]||(i[9]=e("div",{class:"flex-grow-1"},null,-1)),_(F,{message:"main.menu.issue",class:"bb"},{default:b(()=>i[8]||(i[8]=[e("a",{href:"https://github.com/CERES-Sorbonne/Panoptic/issues/new/choose",target:"_blank",class:"bi bi-cone-striped",style:{color:"grey"}},null,-1)])),_:1})]),e("div",Ga,[_(wa,{tab:s.tab,class:"me-1"},null,8,["tab"]),_(_o,{manager:s.tab.collection.filterManager},null,8,["manager"]),_(Wo,{"is-loading":s.computeStatus.groups,manager:s.tab.collection.groupManager},null,8,["is-loading","manager"]),_(ta,{manager:s.tab.collection.sortManager},null,8,["manager"])])],64))}});const Ea=U(Ta,[["__scopeId","data-v-609b9ce1"]]),Pa={class:""},Oa={class:"d-flex flex-row"},La=O({__name:"ImageRecomended",props:{pile:Object,size:{type:Number,default:100}},emits:["accept","refuse"],setup(h,{emit:d}){const s=ue(),a=h,o=d,m=T(()=>`width: ${a.size}px; height: ${a.size}px;`);T(()=>`max-width: ${a.size-2}px; max-height: ${a.size-1}px;`);const p=T(()=>a.pile.images[0]);return(y,v)=>(t(),l("div",Pa,[_(ut,{image:p.value},{default:b(()=>[e("div",{style:X(m.value),class:"img-container",onClick:v[0]||(v[0]=r=>u(s).showModal(u(oe).IMAGE,{image:p.value}))},[_(rt,{image:p.value,width:a.size-2,height:a.size-1},null,8,["image","width","height"])],4)]),_:1},8,["image"]),e("div",Oa,[_(F,{message:"main.recommand.accept"},{default:b(()=>[e("div",{style:X(["width: "+a.size/2+"px;",{"font-size":"10px"}]),class:"text-center text-success validate clickable unselectable",onClick:v[1]||(v[1]=r=>o("accept",p.value))}," ✓ ",4)]),_:1}),_(F,{message:"main.recommand.refuse"},{default:b(()=>[e("div",{style:X(["width: "+a.size/2+"px;",{"font-size":"10px"}]),class:"text-center text-danger refuse clickable unselectable",onClick:v[2]||(v[2]=r=>o("refuse",p.value))}," ✕ ",4)]),_:1})])]))}});const Da=U(La,[["__scopeId","data-v-2ff8fded"]]),Ra={class:"reco-container"},Aa={class:"d-flex flex-row m-0 ps-2 center mb-1 mt-0",style:{height:"25px"}},Ua={key:0,class:"bi bi-funnel-fill bb text-primary"},Ba={key:1,class:"bi bi-funnel bb"},ja={class:"text-secondary me-2"},Na={style:{"padding-top":"2px"},class:"me-1"},Ha={class:"flex-grow-1"},Wa={class:"d-flex flex-row"},qa={key:0,class:"separator"},Ka={class:"d-flex flex-row"},ke=10,Qa=O({__name:"RecommendedMenu",props:{tab:{},imageSize:{},group:{},width:{},height:{}},emits:["scroll","close","update"],setup(h,{emit:d}){const s=K(),a=dt(),o=h,m=d,p=M(1),y=me([]),v=M(null),r=me([]),n=me(new Set),i=M(!0),c=[],f=[];async function S(R){const z=[],w=[];r.forEach($=>{if($.value!=null){const V=s.properties[$.propertyId];let N=$.value;V.type==W.multi_tags?(N=R.properties[$.propertyId]??[],N=[...N,$.value]):V.type==W.tag&&(N=[N]),V.mode==$e.id?w.push({instanceId:R.id,propertyId:V.id,value:N}):z.push({propertyId:V.id,sha1:R.sha1,value:N})}}),await s.setPropertyValues(w,z)}function D(R){v.value.isSha1Group?v.value.images.filter(z=>z.sha1==R.sha1).forEach(z=>n.add(z.id)):n.add(R.id),Q()}function A(){y.length=0;let R=[];const z=f.map(w=>s.instances[w]);if(v.value.isSha1Group){const w={},$=Array.from(new Set(z.map(V=>V.sha1)));$.forEach(V=>w[V]=[]),z.forEach(V=>w[V.sha1].push(V)),$.forEach(V=>R.push({sha1:V,images:s.sha1Index[V]}))}else z.forEach(w=>R.push({sha1:w.sha1,images:[w]}));I(R,y,p.value,o.imageSize,o.width)}function I(R,z,w,$,V){let N=V,Y=[],ae=0;for(let ye=0;ye<R.length&&!(z.length>=w);ye++){let re=R[ye];if(re.images=re.images.filter(Ue=>!n.has(Ue.id)),re.images.length==0)continue;let be=$+ke;if(ae+be<N){Y.push(re),ae+=be;continue}if(Y.length==0)throw new Error("Images seems to be to big for the line");z.push(Y),z.length<w&&(Y=[re],ae=be)}Y.length>0&&z.length<w&&z.push(Y)}async function k(){if(!o.group||!a.hasSimilaryFunction)return;const R=a.defaultActions.similar,z=a.getContext(R);z.instanceIds=o.group.images.map(Y=>Y.id);const w=await a.getSimilarImages(z);if(!w)return;if(!w.groups)throw new Error("No instances in ActionResult");let V=mt(w.groups)[0];if(i.value){const Y=new Set(o.tab.collection.filterManager.result.images.map(ae=>ae.id));V.images=V.images.filter(ae=>Y.has(ae.id))}V.scores&&vt(V),v.value=V,r.length=0;let N=o.group;for(;N;)r.push(...N.meta.propertyValues),N=N.parent;n.clear(),c.length=0,V.images.forEach(Y=>c.push(Y.id)),Q(),m("update")}function G(){i.value=!i.value}function L(){o.tab.collection.groupManager.onResultChange.addListener(Q)}function P(){o.tab.collection.groupManager.onResultChange.removeListener(Q)}function Q(){const R=o.tab.collection.groupManager.result.index[o.group.id];if(!R){m("close");return}f.length=0;const z=new Set(R.images.map(w=>w.id));c.forEach(w=>{z.has(w)||n.has(w)||f.push(w)}),A()}return J(L),Ve(P),J(k),q(()=>o.group,()=>{k(),n.clear()}),q(()=>o.imageSize,A),q(()=>o.width,A),q(i,k),(R,z)=>(t(),l("div",Ra,[e("div",Aa,[_(F,{message:"main.recommand.close"},{default:b(()=>[e("div",{class:"text-secondary pe-1",onClick:z[0]||(z[0]=w=>m("close"))},z[2]||(z[2]=[e("span",{class:"bi bi-x-lg bb"},null,-1)]))]),_:1}),z[5]||(z[5]=e("div",{class:"b-left pe-1"},null,-1)),_(F,{message:"main.recommand.scroll"},{default:b(()=>[e("div",{class:"text-secondary pe-1",onClick:z[1]||(z[1]=w=>m("scroll",o.group.id))},z[3]||(z[3]=[e("span",{class:"bi bi-arrow-down-circle bb"},null,-1)]))]),_:1}),z[6]||(z[6]=e("div",{class:"b-left pe-1"},null,-1)),_(F,{message:"main.recommand.filter"},{default:b(()=>[e("div",{class:"text-secondary pe-1",onClick:G},[i.value?(t(),l("span",Ua)):(t(),l("span",Ba))])]),_:1}),z[7]||(z[7]=e("div",{class:"b-left pe-1"},null,-1)),_(F,{message:"main.recommand.reload"},{default:b(()=>[e("div",{class:"text-secondary pe-1",onClick:k},z[4]||(z[4]=[e("span",{class:"bi bi-arrow-clockwise bb"},null,-1)]))]),_:1}),z[8]||(z[8]=e("div",{class:"b-left pe-1"},null,-1)),_(F,{"icon-pos":"left",message:"main.recommand.tooltip",icon:!0},{default:b(()=>[e("span",ja,x(R.$t("main.recommand.title")),1)]),_:1}),e("div",Na,[_(pt,{action:"similar",onChanged:k})]),e("div",Ha,[e("div",Wa,[(t(!0),l(E,null,j(r,(w,$)=>(t(),l(E,null,[_(ct,{class:"",value:w},null,8,["value"]),$<r.length-1?(t(),l("div",qa)):g("",!0)],64))),256))])])]),e("div",{style:X("margin-left:"+ke+"px;")},[(t(!0),l(E,null,j(y,w=>(t(),l("div",null,[e("div",Ka,[(t(!0),l(E,null,j(w,$=>(t(),C(Da,{pile:$,size:o.imageSize,onAccept:S,onRefuse:D,style:X("margin-right:"+ke+"px;")},null,8,["pile","size","style"]))),256))])]))),256))],4)]))}});const Ya=U(Qa,[["__scopeId","data-v-fe023b30"]]);const Xa={style:{display:"flex"}},Za={class:"info"},Ja={__name:"LineChart",props:{chartData:{series:Array,xValues:Array,dataType:W},height:String},setup(h){const d=h,s=M(0),a=M(!1),o={};Object.keys(d.chartData.series).forEach(i=>{o[i]=!1});const m=M({markers:{size:7},legend:{showForSingleSeries:!0,onItemClick:{toggleDataSeries:!1}},xaxis:{type:d.chartData.dataType===W.date?"datetime":"numeric",categories:d.chartData.xValues},chart:{type:"area",stacked:!1,stackOnlyBar:!1,zoom:{type:"x",autoScaleYaxis:!0},animations:{animateGradually:{enabled:!1,delay:150}}},dataLabels:{enabled:!1},stroke:{curve:"straight"},tooltip:{intersect:!0,shared:!1,custom:function({series:i,seriesIndex:c,dataPointIndex:f,w:S}){const D=d.chartData.series[c].data[f];let A='<div style="display: grid; grid-template-columns: repeat(5, 1fr); grid-gap: 5px;">';D.images.forEach((k,G)=>{G<10&&(A+=`<div style="width: 75px; height: 75px;"><img src="${k}" style="width: 100%; height: 100%;" /></div>`)}),A+="</div>";let I=`<span style="display: flex; align-items: center; justify-content: center;min-height:40px"><b>${d.chartData.series[c].name} — </b> ${D.y} Images</span>`;return I+=`<div>${A}</div>`,I}}}),p=()=>{m.value.chart.stacked=!m.value.chart.stacked,a.value=!a.value,s.value+=1},y=()=>{let i;m.value.chart.type==="area"?i={chart:{...m.value.chart,type:"bar"}}:i={chart:{...m.value.chart,type:"area"}},m.value={...m.value,...i},s.value+=1},v=(i,c,f)=>{const D=d.chartData.series[c];let A=Math.max(...D.data.map(I=>I.y));if(document.querySelectorAll(".apexcharts-custom-image").forEach(I=>I.remove()),o[c]){o[c]=!1;return}D.data.forEach((I,k)=>{const L=Math.floor(I.y/A*17),P=I.images.slice(0,L),Q=`circle[index="${c}"][j="${k}"]`,R=document.querySelector(Q),z=parseFloat(R.getAttribute("cx"));P.forEach((w,$)=>{const V=document.createElement("img");V.src=w,V.width=40,V.height=40,V.style.position="absolute";let N=z+40/1.5,Y=65+$*40;V.style.left=`${N}px`,V.style.bottom=`${Y}px`,V.classList.add("apexcharts-custom-image"),V.addEventListener("mouseover",ae=>r(N,Y,w)),V.addEventListener("mouseout",n),i.el.appendChild(V)})}),Object.keys(o).forEach(I=>o[I]=!1),o[c]=!0};function r(i,c,f){const S=document.getElementById("zoomed-image");S.style.left=`${i+120*1.5}px`,S.src=f,S.style.bottom=`${c}px`,S.style.display="block"}function n(){const i=document.getElementById("zoomed-image");i.style.display="none"}return(i,c)=>{const f=Te("apexchart");return t(),l(E,null,[e("div",Xa,[e("button",{class:"mt-2",onClick:y},x(m.value.chart.type==="area"?i.$t("main.graph-view.histo"):i.$t("main.graph-view.curve")),1),d.chartData.series.length>1?(t(),l("button",{key:0,class:"mt-2",style:{"margin-left":"1em"},onClick:p},x(a.value?i.$t("main.graph-view.over"):i.$t("main.graph-view.stack")),1)):g("",!0)]),(t(),C(f,{style:{position:"relative"},key:s.value,height:d.height,type:m.value.chart.type,options:m.value,series:d.chartData.series,onLegendClick:v},null,8,["height","type","options","series"])),e("i",Za,x(i.$t("main.graph-view.info")),1),c[0]||(c[0]=e("img",{id:"zoomed-image",style:{display:"none",position:"absolute","z-index":"1000",width:"120px",height:"120px","pointer-events":"none"}},null,-1))],64)}}},el={key:1},tl=O({__name:"GraphView",props:{collection:{},height:{}},emits:[],setup(h,{emit:d}){const s=K(),a=h,o=M(""),m=M(y());function p(){const v=new Set;let r=a.collection.groupManager.getGroupIterator();for(;r;){const n=r.group;if(n.id===0||n.meta.propertyValues&&n.meta.propertyValues[0].value==null){r=r.nextGroup();continue}for(let i of n.children)v.add(i.meta.propertyValues[0].value);n.children.forEach(()=>r=r.nextGroup()),r=r.nextGroup()}return v}function y(){const v={};let r,n=a.collection.groupManager.state.groupBy;if(n.length===0){o.value="Choose at least one date or numeric value to group the images by";return}const i=s.properties[n[0]],c=i.type;if(n.length>2){o.value="Only max two levels of grouping are supported";return}else if(n.length===1)v[i.name]={name:i.name,data:[]};else if(r=Array.from(p()),r.length>20){o.value="Too many curves to draw, select a subgrouping with less than 20 possible values";return}if(c!==W.number&&c!==W.date){o.value="First level of grouping needs to be a date or a numeric property";return}let f=a.collection.groupManager.getGroupIterator();const S=[];for(;f;){const D=f.group;if(D.id===0||D.meta.propertyValues&&D.meta.propertyValues[0].value==null){f=f.nextGroup();continue}let A=D.meta.propertyValues[0];const I=c===W.date?new Date(A.value).getTime():A.value;if(S.push(I),i.name in v)v[i.name].data.push({x:I,y:D.images.length,images:D.images.slice(0,20).map(k=>k.urlSmall)});else{const k=D.children.map(L=>L.meta.propertyValues[0].value),G=r.filter(L=>!k.includes(L));for(let L of D.children){const P=L.meta.propertyValues[0].value;if(v[P]===void 0){let Q=P;P in s.tags&&(Q=s.tags[P].value),v[P]={data:[],name:Q}}v[L.meta.propertyValues[0].value].data.push({x:I,y:L.images.length,images:L.images.slice(0,20).map(Q=>Q.urlSmall)})}for(let L of G){if(v[L]===void 0){let P=L;L in s.tags&&(P=s.tags[L].value),v[L]={data:[],name:P}}v[L].data.push({x:I,y:0,images:[]})}D.children.forEach(()=>f=f.nextGroup())}f=f.nextGroup()}return o.value="",{series:Object.values(v),xValues:S,dataType:c}}return a.collection.groupManager.onResultChange.addListener(()=>m.value=y()),(v,r)=>(t(),l("div",{class:"",style:X({height:a.height+"px"})},[o.value===""?(t(),C(Ja,{key:0,chartData:m.value,height:a.height-50+"px"},null,8,["chartData","height"])):(t(),l("span",el,x(o.value),1))],4))}}),sl={key:0,class:"m-0 p-0"},ol={key:0,style:{"margin-left":"10px"}},al=O({__name:"MainView",props:{tab:{},height:{},filterOpen:{type:Boolean}},setup(h,{expose:d}){fe();const s=K(),a=h;d({updateScrollerWidth:A});const o=M({}),m=M(!0),p=M(null),y=M(null),v=M(null),r=M(0),n=M(0),i=me({groups:!1}),c=T(()=>a.tab.getVisibleProperties());function f(){p.value&&y.value?r.value=a.height-p.value.clientHeight-y.value.clientHeight-5:p.value?r.value=a.height-p.value.clientHeight-5:r.value=0}function S(I){o.value=a.tab.collection.groupManager.result.index[I],Z(()=>f())}function D(){o.value={},Z(()=>f())}async function A(){var I;await Z(),n.value=((I=p.value)==null?void 0:I.clientWidth)??n.value}return J(()=>{n.value=p.value.clientWidth,window.addEventListener("resize",A)}),Ve(()=>{window.removeEventListener("resize",A)}),q(()=>a.tab.state.imageSize,()=>Z(f)),q(()=>a.filterOpen,()=>Z(f)),q(()=>a.height,async()=>{await Z(f)}),J(f),J(()=>a.tab.update()),(I,k)=>(t(),l(E,null,[e("div",{id:"main-content",ref_key:"filterElem",ref:p},[a.filterOpen?(t(),C(Ea,{key:0,tab:a.tab,"compute-status":i},null,8,["tab","compute-status"])):g("",!0)],512),e("div",{ref_key:"boxElem",ref:y,class:"m-0 p-0"},[o.value.id?(t(),l("div",sl,[_(Ya,{tab:a.tab,group:o.value,"image-size":a.tab.state.imageSize,width:n.value,height:50,onClose:D,onScroll:v.value.scrollTo,onUpdate:k[0]||(k[0]=G=>Z(()=>f()))},null,8,["tab","group","image-size","width","onScroll"])])):g("",!0)],512),u(s).isLoaded&&n.value>0&&r.value>0&&m.value?(t(),l("div",ol,[a.tab.state.display=="tree"?(t(),C(gt,{key:0,"group-manager":a.tab.collection.groupManager,"image-size":a.tab.state.imageSize,height:r.value-0,properties:c.value,"hide-if-modal":!0,"selected-images":a.tab.collection.groupManager.selectedImages,ref_key:"imageList",ref:v,width:n.value-25,onRecommend:S},null,8,["group-manager","image-size","height","properties","selected-images","width"])):g("",!0),a.tab.state.display=="grid"?(t(),l("div",{key:1,style:X({width:n.value-12+"px"}),class:"p-0 m-0 grid-container"},[_(ft,{tab:I.tab,manager:a.tab.collection.groupManager,height:r.value-15,width:n.value-40,"selected-properties":c.value,class:"p-0 m-0","show-images":!0,"selected-images":a.tab.collection.groupManager.selectedImages,ref_key:"imageList",ref:v,"hide-if-modal":!0},null,8,["tab","manager","height","width","selected-properties","selected-images"])],4)):g("",!0),a.tab.state.display=="graph"?(t(),C(tl,{key:2,collection:a.tab.collection,height:r.value-15},null,8,["collection","height"])):g("",!0)])):g("",!0)],64))}});const ll=U(al,[["__scopeId","data-v-813c6f29"]]),nl=O({__name:"TabButton",props:{tab:{}},setup(h){const d=pe(),s=M(""),a=M(null),o=M(!1),m=M(!1),p=h,y=T(()=>p.tab.state.id);function v(){d.selectMainTab(p.tab.state.id)}function r(){m.value=!0,s.value=p.tab.state.name,Z(()=>a.value.focus())}function n(){p.tab.renameTab(s.value),m.value=!1}async function i(){confirm("Are you sure to delete Tab: "+p.tab.state.name)&&d.deleteTab(p.tab.state.id)}return J(()=>{p.tab.isNew&&r()}),(c,f)=>(t(),l("div",{class:"d-flex d-row me-2",onMouseenter:f[1]||(f[1]=S=>o.value=!0),onMouseleave:f[2]||(f[2]=S=>o.value=!1)},[m.value?(t(),l("div",{key:1,class:H(["tab-button",y.value==u(d).mainTab?" active":""])},[e("form",{onSubmit:ve(n,["stop","prevent"])},[de(e("input",{onFocusout:n,onKeydown:_t(n,["escape"]),type:"text",class:"text-input","onUpdate:modelValue":f[0]||(f[0]=S=>s.value=S),ref_key:"inputElem",ref:a},null,544),[[_e,s.value]])],32)],2)):(t(),l(E,{key:0},[_(F,{message:"main.menu.rename_tab_tooltip"},{default:b(()=>[e("i",{onClick:r,class:H(["bi bi-pencil me-1 tab-icon hover-light",o.value&&u(d).mainTab==y.value?"":"hidden"]),style:{"font-size":"10px"}},null,2)]),_:1}),e("div",{class:H(["tab-button",y.value==u(d).mainTab?" active":""]),onClick:v},[e("span",null,x(p.tab.state.name),1)],2),_(F,{message:"main.menu.delete_tab_tooltip"},{default:b(()=>[e("i",{onClick:i,class:H(["btn-icon bi bi-x tab-icon hover-light",o.value?"":"hidden"]),style:{"font-size":"15px"}},null,2)]),_:1})],64))],32))}});const il={class:"d-flex d-row",style:{cursor:"pointer"}},rl={class:"pt-1"},ul={key:0,class:"bb bi bi-chevron-down"},dl={key:1,class:"bb bi bi-chevron-right"},pl={style:{"padding-top":"2px","margin-right":"2px"}},cl={class:"lang"},ml=["value"],vl=O({__name:"TabNav",props:{reRender:{type:Function},filterOpen:{type:Boolean}},emits:["update:filterOpen"],setup(h,{emit:d}){const s=ue(),a=pe(),o=h,m=d;async function p(r){await a.addTab("New Tab")}const y=["fr","en"];function v(){m("update:filterOpen",!o.filterOpen)}return(r,n)=>(t(),l("nav",null,[e("div",il,[e("div",rl,[e("span",{onClick:v},[o.filterOpen?(t(),l("i",ul)):(t(),l("i",dl))])]),(t(!0),l(E,null,j(u(a).loadedTabs,i=>(t(),l("div",null,[_(nl,{tab:u(a).getTab(i)},null,8,["tab"])]))),256)),_(F,{message:"main.menu.add_tab_tooltip"},{default:b(()=>[e("button",{class:"tab-icon hover-light ps-1 pe-1",onClick:p,id:"add-tab-button"},n[3]||(n[3]=[e("span",{class:"bi bi-plus"},null,-1)]))]),_:1}),n[6]||(n[6]=e("div",{class:"flex-grow-1"},null,-1)),e("div",pl,[_(F,{message:"modals.notif.icon"},{default:b(()=>[e("span",{class:"bb",onClick:n[0]||(n[0]=i=>u(s).showModal(u(oe).NOTIF))},n[4]||(n[4]=[e("i",{class:"bi bi-bell"},null,-1)]))]),_:1})]),e("div",cl,[n[5]||(n[5]=e("i",{class:"bi bi-translate",style:{"margin-right":"0.5rem"}},null,-1)),de(e("select",{"onUpdate:modelValue":n[1]||(n[1]=i=>r.$i18n.locale=i),onChange:n[2]||(n[2]=i=>o.reRender())},[(t(),l(E,null,j(y,(i,c)=>e("option",{key:`Lang${c}`,value:i},x(i.toUpperCase()),9,ml)),64))],544),[[yt,r.$i18n.locale]])])])]))}});const gl={key:0},fl={key:0,class:"spinner-border spinner-border-sm text-primary",style:{position:"relative",top:"-2px"},strole:"status"},ie=O({__name:"LoadWheel",props:{loading:{type:Boolean}},setup(h){const d=h;return(s,a)=>d.loading?(t(),l("div",gl,[s.loading?(t(),l("div",fl,a[0]||(a[0]=[e("span",{class:"visually-hidden"},"Loading...",-1)]))):g("",!0)])):g("",!0)}}),xe=O({__name:"Percentage",props:{current:{},max:{},force:{type:Boolean}},setup(h){const d=h,s=T(()=>d.force?"100%":d.max==0?"0%":d.current>=d.max?"100%":Math.floor(d.current/d.max*100)+"%");return(a,o)=>(t(),l("span",null,x(s.value),1))}}),_l={key:0,class:"center"},yl={class:"text-start",style:{display:"inline-block",width:"200px",height:"300px"}},bl={class:"d-flex text-secondary"},hl={key:0,style:{"font-size":"14px"},class:"bi bi-check text-success"},kl={class:"d-flex text-secondary",style:{"font-size":"14px"}},xl={key:0,class:"bi bi-check text-success"},$l={class:"d-flex text-secondary",style:{"font-size":"14px"}},wl={key:0,class:"bi bi-check text-success"},Sl={class:"d-flex text-secondary",style:{"font-size":"14px"}},Cl={key:0,class:"bi bi-check text-success"},Il={class:"d-flex text-secondary",style:{"font-size":"14px"}},Vl={key:0,class:"bi bi-check text-success"},Ml={class:"d-flex text-secondary",style:{"font-size":"14px"}},zl={key:0,class:"bi bi-check text-success"},Fl=O({__name:"DataLoad",setup(h){const d=K();return(s,a)=>u(d).loadState?(t(),l("div",_l,[e("div",yl,[e("div",null,[e("div",bl,[a[0]||(a[0]=e("div",{class:"me-1",style:{"font-size":"14px"}},"Properties",-1)),_(ie,{class:"me-2",loading:!u(d).loadState.finishedProperty},null,8,["loading"]),u(d).loadState.finishedProperty?(t(),l("i",hl)):g("",!0)]),e("div",kl,[a[1]||(a[1]=e("div",{class:"me-1"},"PropertyGroups",-1)),_(ie,{class:"me-2",loading:!u(d).loadState.finishedPropertyGroups},null,8,["loading"]),u(d).loadState.finishedPropertyGroups?(t(),l("i",xl)):g("",!0)]),e("div",$l,[a[2]||(a[2]=e("div",{class:"me-1"},"Tags",-1)),_(ie,{class:"me-2",loading:!u(d).loadState.finishedTags},null,8,["loading"]),u(d).loadState.finishedTags?(t(),l("i",wl)):g("",!0)]),e("div",Sl,[a[3]||(a[3]=e("div",{class:"me-1"},"Instances",-1)),_(ie,{class:"me-2",loading:!u(d).loadState.finishedInstance},null,8,["loading"]),u(d).loadState.finishedInstance?(t(),l("i",Cl)):g("",!0),_(xe,{current:u(d).loadState.counterInstance,max:u(d).loadState.maxInstance,force:u(d).loadState.finishedInstance},null,8,["current","max","force"])]),e("div",Il,[a[4]||(a[4]=e("div",{class:"me-1"},"InstanceValues",-1)),_(ie,{class:"me-2",loading:!u(d).loadState.finishedInstanceValues},null,8,["loading"]),u(d).loadState.finishedInstanceValues?(t(),l("i",Vl)):g("",!0),_(xe,{current:u(d).loadState.counterInstanceValue,max:u(d).loadState.maxInstanceValue,force:u(d).loadState.finishedInstanceValues},null,8,["current","max","force"])]),e("div",Ml,[a[5]||(a[5]=e("div",{class:"me-1"},"ImageValues",-1)),_(ie,{class:"me-2",loading:!u(d).loadState.finishedImageValues},null,8,["loading"]),u(d).loadState.finishedImageValues?(t(),l("i",zl)):g("",!0),_(xe,{current:u(d).loadState.counterImageValue,max:u(d).loadState.maxImageValue,force:u(d).loadState.finishedImageValues},null,8,["current","max","force"])])])])])):g("",!0)}});const Gl=U(Fl,[["__scopeId","data-v-0db6d675"]]),Tl={key:0},El={class:"d-flex flex-row m-0 p-0 overflow-hidden"},Pl={class:"w-100"},Ol={key:0,class:"custom-hr"},Ll={key:2,class:"loading"},Dl={class:"text-center"},Rl={key:3,class:"loading"},Al=O({__name:"PanopticView",setup(h){const d=fe(),s=K(),a=ue(),o=pe(),m=M(null),p=M(null),y=M(window.innerHeight),v=M(!1),r=M(!0),n=M(!0),i=T(()=>{var G;return y.value-(((G=p.value)==null?void 0:G.clientHeight)??0)}),c=T(()=>{var G;return(G=m.value)==null?void 0:G.filteredImages.map(L=>L.id)});let f=navigator.userAgent.indexOf("Mac OS X")!==-1;async function S(){r.value=!1,await Z(),r.value=!0}J(async()=>{a.isProjectLoaded||Fe.push("/"),Z(()=>{window.addEventListener("resize",D),D()}),window.addEventListener("keydown",G=>{G.key=="Control"&&(B.ctrl=!0),G.key=="Alt"&&(f&&(B.ctrl=!0),B.alt=!0),G.key=="Shift"&&(B.shift=!0),G.key=="ArrowLeft"&&(B.left=!0),G.key=="ArrowRight"&&(B.right=!0,console.log("keeeyy")),G.key=="Z"&&B.ctrl&&s.redo(),G.key=="z"&&B.ctrl&&s.undo()}),window.addEventListener("keyup",G=>{G.key=="Control"&&(B.ctrl=!1),G.key=="Alt"&&(f&&(B.ctrl=!1),B.alt=!1),G.key=="Shift"&&(B.shift=!1),G.key=="ArrowLeft"&&(B.left=!1),G.key=="ArrowRight"&&(B.right=!1)}),window.addEventListener("mousemove",G=>{B.ctrl=G.ctrlKey,B.alt=G.altKey,B.shift=G.shiftKey,f&&(B.ctrl=B.ctrl||B.alt)})}),Ve(()=>{window.removeEventListener("resize",D)});function D(){y.value=window.innerHeight,v.value=!0}function A(){a.showModal(oe.EXPORT,c)}function I(){Fe.push("/")}function k(){m.value&&m.value.updateScrollerWidth()}return(G,L)=>r.value?(t(),l("div",Tl,[m.value&&!m.value.imageList?(t(),C(bt,{key:0,tutorial:"project"})):g("",!0),(t(),l("div",{id:"panoptic",key:u(d).status.renderNb},[e("div",El,[u(s).isLoaded?u(s).isLoaded?(t(),l(E,{key:1},[e("div",null,[_(Ts,{onExport:L[0]||(L[0]=P=>A()),onToggle:k})]),e("div",Pl,[e("div",{class:"ms-1",ref_key:"navElem",ref:p},[_(vl,{"re-render":S,filterOpen:n.value,"onUpdate:filterOpen":L[1]||(L[1]=P=>n.value=P)},null,8,["filterOpen"])],512),v.value?(t(),l("div",Ol)):g("",!0),_(Le,{id:u(o).mainTab},{default:b(({tab:P})=>[_(ll,{tab:P,height:i.value,ref_key:"mainViewRef",ref:m,"filter-open":n.value},null,8,["tab","height","filter-open"])]),_:1},8,["id"])])],64)):u(a).isProjectLoaded?(t(),l("div",Rl,L[2]||(L[2]=[e("i",{class:"spinner-border",role:"status"},null,-1),e("span",{class:"ms-1"},"Loading...",-1)]))):(t(),l("div",Ll,[e("div",Dl,[e("div",null,x(G.$t("main.status.no_project")),1),e("div",{class:"bi bi-house p-3",onClick:I,style:{"font-size":"50px",cursor:"pointer"}})])])):(t(),l("div",{key:0,class:"d-flex flex-column w-100",style:X({height:y.value+"px"})},[_(Gl,{class:"flex-grow-1"})],4))])]))])):g("",!0)}});const jl=U(Al,[["__scopeId","data-v-efb0ce4d"]]);export{jl as default};
