import{S as j,O as F,W as O,V,R as Y,C as D,M as H,I as X,a as p,b as N}from"./three.module-Cl0ZyOCO.js";import{_ as T,r as y,m as q,A as J,a as K,b as u,t as Q,o as Z}from"./index-B18Wh5Nh.js";const $={class:"point-cloud-container"},ee={class:"controls"},te={__name:"TestView",setup(ne,{expose:R}){const b=y(null),f=y(!1);let w,l,d,n,h,M,C,v=0;const k=()=>{const e=window.innerWidth/window.innerHeight,t=10;l=new F(t*e/-2,t*e/2,t/2,t/-2,.1,1e3),l.position.z=5},A=()=>{d=new O({antialias:!0}),d.setSize(window.innerWidth,window.innerHeight),d.setPixelRatio(Math.min(window.devicePixelRatio,2)),d.setClearColor(1710618),b.value.appendChild(d.domElement)},I=()=>{d.domElement.addEventListener("wheel",s=>{s.preventDefault();const a=.1;l.zoom+=s.deltaY>0?-a:a,l.zoom=Math.max(.5,Math.min(10,l.zoom)),l.updateProjectionMatrix()});let e=!1,t={x:0,y:0};d.domElement.addEventListener("mousedown",s=>{e=!0,t={x:s.clientX,y:s.clientY}}),d.domElement.addEventListener("mousemove",s=>{if(!e)return;const a=s.clientX-t.x,r=s.clientY-t.y,c=.01/l.zoom;l.position.x-=a*c,l.position.y+=r*c,t={x:s.clientX,y:s.clientY}}),d.domElement.addEventListener("mouseup",()=>e=!1),d.domElement.addEventListener("mouseleave",()=>e=!1);const m=new Y,o=new V;d.domElement.addEventListener("click",i);function i(s){const a=d.domElement.getBoundingClientRect();o.x=(s.clientX-a.left)/a.width*2-1,o.y=-((s.clientY-a.top)/a.height)*2+1,m.setFromCamera(o,l);const r=m.intersectObject(n);if(r.length>0){const c=r[r.length-1].instanceId;c!==void 0&&P(c)}}};function P(e){const t=new p(Math.random(),Math.random(),Math.random());n.setColorAt(e,t),n.instanceColor.needsUpdate=!0}const E=()=>{const e=window.innerWidth/window.innerHeight,t=10;l.left=t*e/-2,l.right=t*e/2,l.top=t/2,l.bottom=t/-2,l.updateProjectionMatrix(),d.setSize(window.innerWidth,window.innerHeight)},L=e=>{n&&(w.remove(n),n.geometry.dispose(),n.material.dispose()),h=e;const t=new D(.15,32),m=new H({color:16777215}),o=new X(t,m,e.length),i=new p,s=new N;for(let a=0;a<e.length;a++){const r=e[a];s.position.set(r.x,r.y,0),s.updateMatrix(),o.setMatrixAt(a,s.matrix);const c=r.color||{r:1,g:1,b:1};i.setRGB(c.r,c.g,c.b),o.setColorAt(a,i)}o.instanceMatrix.needsUpdate=!0,o.instanceColor.needsUpdate=!0,n=o,w.add(n)},g=(e,t,m,o)=>{if(!n||e<0||e>=n.count)return;const i=new p(t,m,o);n.setColorAt(e,i),n.instanceColor.needsUpdate=!0},_=e=>{if(!n)return;const t=new p;e.forEach(({index:m,r:o,g:i,b:s})=>{m<0||m>=n.count||(t.setRGB(o,i,s),n.setColorAt(m,t))}),n.instanceColor.needsUpdate=!0},S=(e,t,m)=>{if(!n)return;const o=new p(e,t,m);for(let i=0;i<n.count;i++)n.setColorAt(i,o);n.instanceColor.needsUpdate=!0},z=()=>{M=requestAnimationFrame(z),d.render(w,l)},B=()=>{for(let e=0;e<h.length;e++)g(e,Math.random(),Math.random(),Math.random())},U=()=>{for(let e=0;e<Math.min(100,h.length);e++)g(e,1,0,0)},G=()=>{const e=[];for(let t=100;t<Math.min(200,h.length);t++)e.push({index:t,r:0,g:1,b:0});_(e)},W=()=>{f.value=!f.value,f.value?C=setInterval(()=>{v=(v+1)%360;const e=v/360,t=1,m=.5,o=(1-Math.abs(2*m-1))*t,i=o*(1-Math.abs(e*6%2-1)),s=m-o/2;let a,r,c;e<1/6?(a=o,r=i,c=0):e<2/6?(a=i,r=o,c=0):e<3/6?(a=0,r=o,c=i):e<4/6?(a=0,r=i,c=o):e<5/6?(a=i,r=0,c=o):(a=o,r=0,c=i);for(let x=200;x<Math.min(300,h.length);x++)g(x,a+s,r+s,c+s)},50):clearInterval(C)};return q(()=>{w=new j,k(),A(),I();const e=[];for(let t=0;t<100;t++)e.push({x:(Math.random()-.5)*8,y:(Math.random()-.5)*8,color:{r:Math.random(),g:Math.random(),b:Math.random()}});L(e),z(),window.addEventListener("resize",E)}),J(()=>{window.removeEventListener("resize",E),M&&cancelAnimationFrame(M),C&&clearInterval(C),n&&(n.geometry.dispose(),n.material.dispose()),d&&d.dispose()}),R({setPointColor:g,setPointColors:_,setAllPointsColor:S}),(e,t)=>(Z(),K("div",$,[u("div",{ref_key:"canvasContainer",ref:b,class:"canvas-wrapper"},null,512),u("div",ee,[u("button",{onClick:B},"Randomize Colors"),u("button",{onClick:U},"Make First 100 Red"),u("button",{onClick:G},"Make Next 100 Green"),u("button",{onClick:W},Q(f.value?"Stop":"Start")+" Color Animation",1)])]))}},ae=T(te,[["__scopeId","data-v-5d7dce15"]]);export{ae as default};
